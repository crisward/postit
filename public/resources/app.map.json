{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","client/app.coffee","node_modules/riot/riot.js","client/tags/app.tag","client/tags/board.tag","client/tags/note.tag"],"names":["riot","window","require","mount","undefined","mkitem","expr","key","val","item","pos","unmountRedundant","items","tags","t","i","length","j","splice","unmount","moveNestedTags","child","Object","keys","forEach","tagName","tag","isArray","each","moveChildTag","addVirtual","src","target","sib","el","_root","_virts","nextSibling","insertBefore","appendChild","push","moveVirtual","len","_each","dom","parent","remAttr","hasKeys","mustReorder","getAttr","T_STRING","getTagName","impl","__tagImpl","tmpl","getOuterHTML","useRoot","SPECIAL_TAGS_REGEX","test","root","parentNode","ref","document","createTextNode","getTag","isOption","toLowerCase","oldItems","isVirtual","loopKeys","one","removeChild","stub","on","frag","createDocumentFragment","map","itemsLength","_mustReorder","T_OBJECT","oldPos","indexOf","Tag","isLoop","hasImpl","cloneNode","innerHTML","firstChild","update","childNodes","_item","defineProperty","FIREFOX","multiple","n","__riot1374","selectedIndex","slice","parseNamedElements","childTags","forceParsingNamed","walk","nodeType","initChildTag","setNamed","parseExpressions","expressions","addExpr","extra","hasExpr","extend","attr","type","nodeValue","attributes","name","bool","split","value","conf","updateOpts","ctx","self","opts","toCamel","normalizeData","data","T_UNDEF","isWritable","inheritFromParent","k","mustSync","RESERVED_WORDS_BLACKLIST","contains","propsInSyncWithParent","onChildUpdate","toggle","isMount","evt","observable","this","inherit","cleanUpData","_tag","isMounted","__uid","mkdom","isInherited","isObject","trigger","rAF","arguments","mix","instance","obj","props","mixin","isFunction","concat","getOwnPropertyNames","getPrototypeOf","bind","init","globalMixin","GLOBAL_MIXIN","hasOwnProperty","fn","call","attrs","walkAttributes","v","setAttr","isInStub","keepRootTag","ptag","p","tagIndex","__virtualDom","getImmediateCustomParentTag","_riot_id","RIOT_TAG_IS","RIOT_TAG","off","setEventHandler","handler","e","_parent","event","currentTarget","srcElement","which","charCode","keyCode","preventDefault","returnValue","preventUpdate","insertTo","node","before","attrName","IE_VERSION","add","remove","inStub","style","display","startsWith","RIOT_PREFIX","els","T_FUNCTION","outerHTML","container","mkEl","setInnerHTML","html","doc","DOMParser","parseFromString","ownerDocument","importNode","documentElement","isSVGTag","SVG_TAGS_LIST","removeAttribute","string","replace","_","c","toUpperCase","getAttribute","setAttribute","addChildTag","cachedTag","newPos","options","enumerable","writable","configurable","namedTag","args","arr","a","Array","getOwnPropertyDescriptor","o","m","re","exec","isSvg","createElementNS","createElement","$$","selector","querySelectorAll","$","querySelector","Child","prototype","getNamedKey","isArr","str","mountTo","_innerHTML","version","settings","documentMode","InstallTrigger","onEachEvent","indx","es","l","substring","callbacks","defineProperties","events","ns","typed","cb","apply","fns","arglen","busy","DEFAULT_PARSER","path","DEFAULT_SECOND_PARSER","filter","RegExp","REPLACE","match","debounce","delay","clearTimeout","setTimeout","start","autoExec","debouncedEmit","emit","win","ADD_EVENT_LISTENER","POPSTATE","HASHCHANGE","clickEvent","click","Router","central","s","normalize","isString","getPathFromRoot","href","loc","RE_ORIGIN","getPathFromBase","base","force","isRoot","emitStackLevel","MAX_EMIT_STACK_LEVEL","emitStack","current","TRIGGER","shift","metaKey","ctrlKey","shiftKey","defaultPrevented","nodeName","HAS_ATTRIBUTE","go","title","shouldReplace","hist","replaceState","pushState","routeFound","parser","secondParser","EVENT_LISTENER","REMOVE_EVENT_LISTENER","history","location","prot","ontouchstart","started","first","second","third","r","some","action","mainRouter","route","create","newSubRouter","router","stop","arg","fn2","query","q","readyState","brackets","UNDEF","_loopback","_rewrite","bp","_cache","source","global","REGLOB","_create","pair","DEFAULT","_pairs","Error","S_QBLOCKS","_brackets","reOrIdx","_regex","_reset","cachedBrackets","_setSettings","b","set","get","_settings","R_MLCOMMS","R_STRINGS","FINDBRACES","(","[","{","_bp","unescapeStr","isexpr","parts","skipBraces","ch","ix","recch","lastIndex","index","trim","array","_tmpl","_logErr","err","errorHandler","riotData","_getTmpl","Function","qstr","RE_DQUOTE","list","_parseExpr","join","RE_QBMARK","asText","mm","lv","ir","RE_BREND","RE_QBLOCK","div","CH_IDEXPR","cnt","RE_CSNAME","jsb","rightContext","_wrapExpr","tb","JS_VARNAME","mvar","JS_CONTEXT","JS_NOPROPS","haveRaw","hasRaw","parse","_mkdom","templ","replaceYield","tblTags","specialTags","select","tname","rootEls","childElementCount","reHasYield","reYieldSrc","text","reYieldDest","def","reYieldAll","tr","th","td","col","styleManager","_riot","inject","styleNode","newNode","userNode","id","replaceChild","getElementsByTagName","cssTextProp","styleSheet","stylesToInject","css","cssText","w","raf","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","navigator","userAgent","lastTime","nowtime","Date","now","timeout","Math","max","util","mixins","globals","_id","g","store","tag2","addRiotTags","selectAllTags","pushTags","riotTag","allTags","nodeList","_el","vdom","exports","module","define","amd","notes","socket","WebSocket","onopen","_this","getNotes","onmessage","res","message","JSON","updateAll","console","log","addnote","top","left","editing","note","send","stringify","noteSelected","idx","active","noteChange","className","dragstart","moved","chosen","startNote","getBoundingClientRect","startMouse","x","clientX","y","clientY","updateOffset","addEventListener","dragging","dragend","offset","removeEventListener","changed","startEdit","endEdit"],"mappings":"AAAA;ACAA,GAAAA,KAAAC,QAAOD,KAAOA,KAAOE,QAAQ,QAC7BA,QAAQ,kBACRA,QAAQ,oBACRA,QAAQ,mBAERF,KAAKG,MAAM;;AELX,GAAIH,MAAOE,QAAQ,OACnBmf,QAAOD,QACPpf,KAAK2e,KAAK,MAAO,kBAAmB,sEAAuE,GAAI,SAAShX;;ACFxH,GAAI3H,MAAOE,QAAQ,OACnBmf,QAAOD,QACPpf,KAAK2e,KAAK,QAAS,gTAAiT,6OAA8O,GAAI,SAAShX,MAC/jBiB,KAAK4W,SAEL5W,KAAKnE,GAAG,QAAS,WAOf,MANAmE,MAAK6W,OAAS,GAAIC,WAAU,uBAC5B9W,KAAK6W,OAAOE,OAAS,SAAUC,OAC7B,MAAO,YACL,MAAOA,OAAMC,aAEdjX,MACIA,KAAK6W,OAAOK,UAAY,SAAUF,OACvC,MAAO,UAASG,KACd,GAAIC,QAEJ,QADAA,QAAUC,KAAK5E,MAAM0E,IAAIjY,MACjBkY,QAAQhZ,MACd,IAAK,YACH,MAAO4Y,OAAMM,UAAUF,QAAQR,MACjC,SACE,MAAOW,SAAQC,IAAIJ,QAAQhZ,KAAM,gBAGtC4B,QAGLA,KAAKyX,QAAU,SAAUT,OACvB,MAAO,YACL,GAAI9X,KAgBJ,OAfA8X,OAAMJ,MAAMhd,MACV8d,IAAK,IACLC,KAAM,IACNtE,KAAM,WACNuE,SAAS,IAEX1Y,MACEd,KAAM,YACNyZ,MACEH,IAAK,IACLC,KAAM,IACNtE,KAAM,aAGV2D,MAAMH,OAAOiB,KAAKT,KAAKU,UAAU7Y,OAC1B8X,MAAMpa,WAEdoD,MAEHA,KAAKgY,aAAe,SAAUhB,OAC5B,MAAO,UAASiB,KAGd,MAFAV,SAAQC,IAAI,WAAYS,KACxBjB,MAAMkB,OAASD,IACRjB,MAAMpa,WAEdoD,MAEHA,KAAKmY,WAAa,SAAUnB,OAC1B,MAAO,UAASiB,IAAKJ,MASnB,MARAA,MAAK1D,GAAK6C,MAAMJ,MAAMqB,KAAK9D,GAC3B6C,MAAMJ,MAAMqB,KAAOJ,KACdA,KAAKD,SACRZ,MAAMH,OAAOiB,KAAKT,KAAKU,WACrB3Z,KAAM,eACNyZ,KAAMA,QAGHb,MAAMpa,WAEdoD,MAEHA,KAAKiX,SAAW,SAAUD,OACxB,MAAO,YACL,GAAI9X,KAIJ,OAHAA,OACEd,KAAM,gBAED4Y,MAAMH,OAAOiB,KAAKT,KAAKU,UAAU7Y,SAEzCc,MAEHA,KAAKsX,UAAY,SAAUN,OACzB,MAAO,UAASJ,OAGd,MAFAI,OAAMJ,MAAQA,MACdW,QAAQC,IAAI,YAAaR,MAAMJ,OACxBI,MAAMpa,WAEdoD;;ACtFH,GAAI5I,MAAOE,QAAQ,OACnBmf,QAAOD,QACPpf,KAAK2e,KAAK,OAAQ,2RAA4R,+qBAAgrB,qDAAsD,SAAShX,MAC7hCiB,KAAKnE,GAAG,QAAS,WACf,MAAOmE,MAAKjF,KAAKqd,WAAa,aAGhCpY,KAAKqY,UAAY,SAAUrB,OACzB,MAAO,UAASnU,GAYd,MAXAmU,OAAMsB,OAAQ,EACdtB,MAAMjc,KAAKqd,UAAYpB,MAAMjc,KAAKqd,UAAU/S,QAAQ,YAAa,IAC7DtG,KAAKwZ,QACPxZ,KAAKwZ,OAAOxZ,KAAKkZ,KAEnBjB,MAAMwB,UAAYxB,MAAMjc,KAAK0d,wBAC7BzB,MAAM0B,YACJC,EAAG9V,EAAE+V,QACLC,EAAGhW,EAAEiW,SAEP9B,MAAM+B,aAAa/B,MAAM0B,cACrB3Z,KAAK6Y,UAGT1c,SAAS8d,iBAAiB,YAAahC,MAAMiC,UACtC/d,SAAS8d,iBAAiB,UAAWhC,MAAMkC,YAEnDlZ,MAEHA,KAAKiZ,SAAW,SAAUjC,OACxB,MAAO,UAASnU,GAQd,MAPAmU,OAAMsB,OAAQ,EACdtB,MAAMlf,KACJ6gB,EAAG9V,EAAE+V,QACLC,EAAGhW,EAAEiW,SAEP9B,MAAM+B,aAAa/B,MAAMlf,KACzBkf,MAAMjc,KAAKiJ,MAAM2T,KAAOX,MAAMmC,OAAOR,EAAI,KAClC3B,MAAMjc,KAAKiJ,MAAM0T,IAAMV,MAAMmC,OAAON,EAAI,OAEhD7Y,MAEHA,KAAK+Y,aAAe,SAAU/B,OAC5B,MAAO,UAASlf,KACd,MAAOkf,OAAMmC,QACXR,EAAG7gB,IAAI6gB,EAAI3B,MAAM0B,WAAWC,EAAI3B,MAAMwB,UAAUb,KAChDkB,EAAG/gB,IAAI+gB,EAAI7B,MAAM0B,WAAWG,EAAI7B,MAAMwB,UAAUd,OAGnD1X,MAEHA,KAAKkZ,QAAU,SAAUlC,OACvB,MAAO,UAASnU,GAId,GAHAmU,MAAMjc,KAAKqd,WAAa,WACxBld,SAASke,oBAAoB,YAAapC,MAAMiC,UAChD/d,SAASke,oBAAoB,UAAWpC,MAAMkC,SAC1ClC,MAAMsB,MACR,MAAOvZ,MAAKsa,QAAQta,KAAKkZ,KACvBP,IAAKV,MAAMmC,OAAON,EAClBlB,KAAMX,MAAMmC,OAAOR,EACnBtF,KAAMtU,KAAKsU,KACXuE,QAAS7Y,KAAK6Y,YAInB5X,MAEHA,KAAKsZ,UAAY,SAAUtC,OACzB,MAAO,YACL,MAAOjY,MAAKsa,QAAQta,KAAKkZ,KACvBP,IAAKV,MAAMmC,OAAON,EAClBlB,KAAMX,MAAMmC,OAAOR,EACnBtF,KAAMtU,KAAKsU,KACXuE,SAAS,MAGZ5X,MAEHA,KAAKuZ,QAAU,SAAUvC,OACvB,MAAO,YACL,MAAOjY,MAAKsa,QAAQta,KAAKkZ,KACvBP,IAAKV,MAAMmC,OAAON,EAClBlB,KAAMX,MAAMmC,OAAOR,EACnBtF,KAAM2D,MAAM3D,KAAK3U,MACjBkZ,SAAS,MAGZ5X;;CHpFF,SAAU3I,OAAQG,WACjB,YA6iCF,SAASC,QAAOC,KAAMC,IAAKC,KACzB,GAAIC,QAGJ,OAFAA,MAAKH,KAAKC,KAAOA,IACbD,KAAKI,MAAKD,KAAKH,KAAKI,KAAOF,KACxBC,KAQT,QAASE,kBAAiBC,MAAOC,MAM/B,IAJA,GAEEC,GAFEC,EAAIF,KAAKG,OACXC,EAAIL,MAAMI,OAGLD,EAAIE,GACTH,EAAID,OAAOE,GACXF,KAAKK,OAAOH,EAAG,GACfD,EAAEK,UASN,QAASC,gBAAeC,MAAON,GAC7BO,OAAOC,KAAKF,MAAMR,MAAMW,QAAQ,SAASC,SACvC,GAAIC,KAAML,MAAMR,KAAKY,QACjBE,SAAQD,KACVE,KAAKF,IAAK,SAAUZ,GAClBe,aAAaf,EAAGW,QAASV,KAG3Bc,aAAaH,IAAKD,QAASV,KAUjC,QAASe,YAAWJ,IAAKK,IAAKC,QAC5B,GAAoBC,KAAhBC,GAAKR,IAAIS,KAEb,KADAT,IAAIU,UACGF,IACLD,IAAMC,GAAGG,YACLL,OACFD,IAAIO,aAAaJ,GAAIF,OAAOG,OAE5BJ,IAAIQ,YAAYL,IAElBR,IAAIU,OAAOI,KAAKN,IAChBA,GAAKD,IAWT,QAASQ,aAAYf,IAAKK,IAAKC,OAAQU,KAErC,IADA,GAAoBT,KAAhBC,GAAKR,IAAIS,MAAYpB,EAAI,EACtBA,EAAI2B,IAAK3B,IACdkB,IAAMC,GAAGG,YACTN,IAAIO,aAAaJ,GAAIF,OAAOG,OAC5BD,GAAKD,IAWT,QAASU,OAAMC,IAAKC,OAAQvC,MAG1BwC,QAAQF,IAAK,OAEb,IAUEG,SAVEC,kBAAqBC,SAAQL,IAAK,gBAAkBM,UAAYJ,QAAQF,IAAK,cAC/EnB,QAAU0B,WAAWP,KACrBQ,KAAOC,UAAU5B,WAAc6B,KAAMC,aAAaX,MAClDY,QAAUC,mBAAmBC,KAAKjC,SAClCkC,KAAOf,IAAIgB,WACXC,IAAMC,SAASC,eAAe,IAC9B1C,MAAQ2C,OAAOpB,KACfqB,SAAqC,WAA1BxC,QAAQyC,cACnBrD,QACAsD,YAEAC,UAA2B,WAAfxB,IAAInB,OAGlBnB,MAAOgD,KAAKe,SAAS/D,MAGrBqD,KAAKrB,aAAauB,IAAKjB,KAGvBC,OAAOyB,IAAI,eAAgB,WAGzB1B,IAAIgB,WAAWW,YAAY3B,KACvBe,KAAKa,OAAMb,KAAOd,OAAOc,QAE5Bc,GAAG,SAAU,WAEd,GAAI7D,OAAQ0C,KAAKhD,KAAKE,IAAKqC,QAEzB6B,KAAOZ,SAASa,wBAGbhD,SAAQf,SACXmC,QAAUnC,QAAS,EACnBA,MAAQmC,QACNzB,OAAOC,KAAKX,OAAOgE,IAAI,SAAUrE,KAC/B,MAAOF,QAAOC,KAAMC,IAAKK,MAAML,WAQrC,KAHA,GAAIQ,GAAI,EACN8D,YAAcjE,MAAMI,OAEfD,EAAI8D,YAAa9D,IAAK,CAE3B,GACEN,MAAOG,MAAMG,GACb+D,aAAe9B,mBAAsBvC,OAAQsE,WAAahC,QAC1DiC,OAASb,SAASc,QAAQxE,MAC1BC,KAAOsE,QAAUF,aAAeE,OAASjE,EAEzCW,IAAMb,KAAKH,IAEbD,OAAQsC,SAAWzC,KAAKC,IAAMF,OAAOC,KAAMG,KAAMM,GAAKN,MAInDqE,eAAiBpD,KAElBoD,gBAAkBE,SAAWtD,KAG7BA,IAAM,GAAIwD,KAAI9B,MACZP,OAAQA,OACRsC,QAAQ,EACRC,UAAW/B,UAAU5B,SACrBkC,KAAMH,QAAUG,KAAOf,IAAIyC,YAC3B5E,KAAMA,MACLmC,IAAI0C,WAEP5D,IAAIvB,QAEAiE,YAAW1C,IAAIS,MAAQT,IAAIiC,KAAK4B,YAEhCxE,GAAKF,KAAKG,QAAWH,KAAKE,IAOxBqD,UACFtC,WAAWJ,IAAKiC,KAAM9C,KAAKE,IACxB4C,KAAKrB,aAAaZ,IAAIiC,KAAM9C,KAAKE,GAAG4C,MACzCQ,SAASjD,OAAOH,EAAG,EAAGN,OATlB2D,UACFtC,WAAWJ,IAAKgD,MACbA,KAAKnC,YAAYb,IAAIiC,MAU5B9C,KAAKK,OAAOH,EAAG,EAAGW,KAClBhB,IAAMK,GACDW,IAAI8D,OAAO/E,MAAM,GAItBC,MAAQK,GAAK+D,cACbjE,KAAKE,KAGDqD,UACF3B,YAAYf,IAAKiC,KAAM9C,KAAKE,GAAI6B,IAAI6C,WAAWzE,QAC5C2C,KAAKrB,aAAaZ,IAAIiC,KAAM9C,KAAKE,GAAG4C,MAErCrD,KAAKI,MACPgB,IAAIpB,KAAKI,KAAOK,GAElBF,KAAKK,OAAOH,EAAG,EAAGF,KAAKK,OAAOR,IAAK,GAAG,IAEtCyD,SAASjD,OAAOH,EAAG,EAAGoD,SAASjD,OAAOR,IAAK,GAAG,KAGzCW,OAASK,IAAIb,MAAMO,eAAeM,IAAKX,IAK9CW,IAAIgE,MAAQjF,KAEZkF,eAAejE,IAAK,UAAWmB,QAQjC,GAJAlC,iBAAiBC,MAAOC,MAGxB8C,KAAKrB,aAAaoC,KAAMb,KACpBI,UAGE2B,UAAYjC,KAAKkC,SACnB,IAAK,GAAIC,GAAI,EAAGA,EAAInC,KAAK3C,OAAQ8E,IAC/B,GAAInC,KAAKmC,GAAGC,WAAY,CACtBpC,KAAKqC,cAAgBF,QACdnC,MAAKmC,GAAGC,UACf,OAWJ1E,QAAOwB,OAAOhC,KAAKY,SAAWZ,MAGlCsD,SAAWvD,MAAMqF,UAoErB,QAASC,oBAAmBvC,KAAMjC,IAAKyE,UAAWC,mBAEhDC,KAAK1C,KAAM,SAASf,KAClB,GAAoB,GAAhBA,IAAI0D,SAAe,CAMrB,GALA1D,IAAIuC,OAASvC,IAAIuC,QACJvC,IAAIgB,YAAchB,IAAIgB,WAAWuB,QAAUlC,QAAQL,IAAK,QACrD,EAAI,EAGhBuD,UAAW,CACb,GAAI9E,OAAQ2C,OAAOpB,IAEfvB,SAAUuB,IAAIuC,QAChBgB,UAAU3D,KAAK+D,aAAalF,OAAQsC,KAAMf,IAAKC,OAAQnB,KAAMkB,IAAI0C,UAAW5D,MAG3EkB,IAAIuC,SAAUiB,mBACjBI,SAAS5D,IAAKlB,WAOtB,QAAS+E,kBAAiB9C,KAAMjC,IAAKgF,aAEnC,QAASC,SAAQ/D,IAAKpC,IAAKoG,OACrBtD,KAAKuD,QAAQrG,MACfkG,YAAYlE,KAAKsE,QAASlE,IAAKA,IAAKtC,KAAME,KAAOoG,QAIrDP,KAAK1C,KAAM,SAASf,KAClB,GACEmE,MADEC,KAAOpE,IAAI0D,QAKf,IADY,GAARU,MAAuC,SAA1BpE,IAAIgB,WAAWnC,SAAoBkF,QAAQ/D,IAAKA,IAAIqE,WACzD,GAARD,KAOJ,OAFAD,KAAO9D,QAAQL,IAAK,UAERD,MAAMC,IAAKlB,IAAKqF,OAAc,IAG1CnF,KAAKgB,IAAIsE,WAAY,SAASH,MAC5B,GAAII,MAAOJ,KAAKI,KACdC,KAAOD,KAAKE,MAAM,MAAM,EAG1B,IADAV,QAAQ/D,IAAKmE,KAAKO,OAASP,KAAMK,MAAQD,KAAMC,KAAMA,OACjDA,KAA4B,MAApBtE,SAAQF,IAAKuE,OAAc,KAKrCnD,OAAOpB,MAAX,UAKJ,QAASsC,KAAI9B,KAAMmE,KAAMjC,WA6CvB,QAASkC,cACP,GAAIC,KAAMrC,SAAWD,OAASuC,KAAO7E,QAAU6E,IAG/C9F,MAAK+B,KAAKuD,WAAY,SAAShF,IAC7B,GAAI1B,KAAM0B,GAAGoF,KACbK,MAAKC,QAAQ1F,GAAGiF,OAAS7D,KAAKuD,QAAQrG,KAAO8C,KAAK9C,IAAKiH,KAAOjH,MAGhEoB,KAAKN,OAAOC,KAAKwF,MAAO,SAASI,MAC/BQ,KAAKC,QAAQT,OAAS7D,KAAKyD,KAAKI,MAAOM,OAI3C,QAASI,eAAcC,MACrB,IAAK,GAAIvH,OAAOE,YACHiH,MAAKnH,OAASwH,SAAWC,WAAWN,KAAMnH,OACnDmH,KAAKnH,KAAOuH,KAAKvH,MAIvB,QAAS0H,qBACFP,KAAK7E,QAAWsC,QACrBvD,KAAKN,OAAOC,KAAKmG,KAAK7E,QAAS,SAASqF,GAEtC,GAAIC,WAAYC,yBAAyB1E,KAAKwE,IAAMG,SAASC,sBAAuBJ,UACzER,MAAKQ,KAAOH,SAAWI,YAG3BA,UAAUG,sBAAsB9F,KAAK0F,GAC1CR,KAAKQ,GAAKR,KAAK7E,OAAOqF,MAoM5B,QAASK,eAAcT,MAAQJ,KAAKlC,OAAOsC,MAAM,GAEjD,QAASU,QAAOC,SAMd,GAHA7G,KAAKuE,UAAW,SAAS9E,OAASA,MAAMoH,QAAU,QAAU,eAGvD5F,OAAL,CACA,GAAI6F,KAAMD,QAAU,KAAO,KAGvBtD,QACFtC,OAAO6F,KAAK,UAAWhB,KAAKvG,SAE5B0B,OAAO6F,KAAK,SAAUH,eAAeG,KAAK,UAAWhB,KAAKvG,UA5R9D,GAYEyB,KAZE8E,KAAO1H,KAAK2I,WAAWC,MACzBjB,KAAOkB,QAAQtB,KAAKI,UACpB9E,OAAS0E,KAAK1E,OACdsC,OAASoC,KAAKpC,OACdC,QAAUmC,KAAKnC,QACf3E,KAAOqI,YAAYvB,KAAK9G,MACxBiG,eACAP,aACAxC,KAAO4D,KAAK5D,KACZlC,QAAUkC,KAAKlC,QAAQyC,cACvB6C,QACAuB,wBAIElF,MAAK+D,MAAQxD,KAAKoF,MAAMpF,KAAKoF,KAAK5H,SAAQ,GAG9CyH,KAAKI,WAAY,EACjBrF,KAAKwB,OAASA,OAIdxB,KAAKoF,KAAOH,KAIZjD,eAAeiD,KAAM,aAAcK,OAEnCnC,OAAO8B,MAAQ/F,OAAQA,OAAQc,KAAMA,KAAMgE,KAAMA,MAAOlH,MAExDkF,eAAeiD,KAAM,WAGrBhH,KAAK+B,KAAKuD,WAAY,SAAShF,IAC7B,GAAI1B,KAAM0B,GAAGoF,KAEThE,MAAKuD,QAAQrG,OAAMuG,KAAK7E,GAAGiF,MAAQ3G,OAGzCoC,IAAMsG,MAAM9F,KAAKE,KAAMgC,WA4CvBK,eAAeiD,KAAM,SAAU,SAASd,KAAMqB,aA0B5C,MAtBArB,MAAOgB,YAAYhB,MAEnBG,oBAEIH,MAAQsB,SAAS3I,QACnBoH,cAAcC,MACdrH,KAAOqH,MAEThB,OAAOY,KAAMI,MACbN,aACAE,KAAK2B,QAAQ,SAAUvB,MACvBtC,OAAOkB,YAAagB,MAMhByB,aAAezB,KAAK7E,OAEtB6E,KAAK7E,OAAOyB,IAAI,UAAW,WAAaoD,KAAK2B,QAAQ,aAClDC,IAAI,WAAa5B,KAAK2B,QAAQ,aAE5BT,OAGTjD,eAAeiD,KAAM,QAAS,WA+B5B,MA9BAhH,MAAK2H,UAAW,SAASC,KACvB,GAAIC,UAEFC,IADAC,QAGFH,WAAaA,OAAQtG,SAAWlD,KAAK4J,MAAMJ,KAAOA,IAKhDC,SAFEI,WAAWL,KAEF,GAAIA,KACCA,GAGlB,GAAGG,OAAQA,MAAMG,OAAOxI,OAAOyI,oBAAoBL,KAAOD,iBACnDC,IAAMpI,OAAO0I,eAAeN,KAAOD,UAG1C7H,MAAK+H,MAAO,SAASpJ,KAER,QAAPA,KAAkBmH,KAAKnH,OAEzBmH,KAAKnH,KAAOsJ,WAAWJ,SAASlJ,MAC9BkJ,SAASlJ,KAAK0J,KAAKvC,MACnB+B,SAASlJ,QAIXkJ,SAASS,MAAMT,SAASS,KAAKD,KAAKvC,UAEjCkB,OAGTjD,eAAeiD,KAAM,QAAS,WAE5BpB,YAGA,IAAI2C,aAAcnK,KAAK4J,MAAMQ,aAC7B,IAAID,YACF,IAAK,GAAIpJ,KAAKoJ,aACRA,YAAYE,eAAetJ,IAC7B2G,KAAKkC,MAAMO,YAAYpJ,GAuB7B,IApBIqC,KAAKkH,IAAIlH,KAAKkH,GAAGC,KAAK7C,KAAMC,MAGhClB,iBAAiB7D,IAAK8E,KAAMhB,aAG5B8B,QAAO,GAIHpF,KAAKoH,OACPC,eAAerH,KAAKoH,MAAO,SAAUtC,EAAGwC,GAAKC,QAAQhH,KAAMuE,EAAGwC,MAC5DtH,KAAKoH,OAASpF,UAChBqB,iBAAiBiB,KAAK/D,KAAM+D,KAAMhB,aAE/BgB,KAAK7E,SAAUsC,QAAQuC,KAAKlC,OAAO/E,MAGxCiH,KAAK2B,QAAQ,gBAETlE,SAAWC,QAEbzB,KAAOf,IAAI2C,eACN,CACL,KAAO3C,IAAI2C,YAAY5B,KAAKpB,YAAYK,IAAI2C,WACxC5B,MAAKa,OAAMb,KAAOd,OAAOc,MAG/BgC,eAAe+B,KAAM,OAAQ/D,MAIzBwB,QACFe,mBAAmBwB,KAAK/D,KAAM+D,KAAK7E,OAAQ,MAAM,IAG9C6E,KAAK7E,QAAU6E,KAAK7E,OAAOmG,WAC9BtB,KAAKsB,WAAY,EACjBtB,KAAK2B,QAAQ,UAGV3B,KAAK7E,OAAOyB,IAAI,QAAS,WAGvBsG,SAASlD,KAAK/D,QACjB+D,KAAK7E,OAAOmG,UAAYtB,KAAKsB,WAAY,EACzCtB,KAAK2B,QAAQ,cAMnB1D,eAAeiD,KAAM,UAAW,SAASiC,aACvC,GAEEC,MAFE5I,GAAKyB,KACPoH,EAAI7I,GAAG0B,WAEPoH,SAAWC,aAAahG,QAAQyC,KAQlC,IANAA,KAAK2B,QAAQ,mBAGR2B,UACHC,aAAa/J,OAAO8J,SAAU,GAE5BD,EAAG,CAEL,GAAIlI,OACFiI,KAAOI,4BAA4BrI,QAI/BlB,QAAQmJ,KAAKjK,KAAKY,UACpBG,KAAKkJ,KAAKjK,KAAKY,SAAU,SAASC,IAAKX,GACjCW,IAAIyJ,UAAYzD,KAAKyD,UACvBL,KAAKjK,KAAKY,SAASP,OAAOH,EAAG,KAIjC+J,KAAKjK,KAAKY,SAAWrB,cAIvB,MAAO8B,GAAGqD,YAAYrD,GAAGqC,YAAYrC,GAAGqD,WAErCsF,cAIH/H,QAAQiI,EAAGK,aACXtI,QAAQiI,EAAGM,WAJXN,EAAExG,YAAYrC,IASd0G,KAAKxG,QACPR,KAAKgH,KAAKxG,OAAQ,SAASsI,GACrBA,EAAE9G,YAAY8G,EAAE9G,WAAWW,YAAYmG,KAI/ChD,KAAK2B,QAAQ,WACbb,SACAd,KAAK4D,IAAI,KACT5D,KAAKsB,WAAY,QACVrF,MAAKoF,OA2Bd7C,mBAAmBtD,IAAKgG,KAAMzC,WAUhC,QAASoF,iBAAgBpE,KAAMqE,QAAS5I,IAAKlB,KAE3CkB,IAAIuE,MAAQ,SAASsE,GAEnB,GAEEvJ,IAFE4I,KAAOpJ,IAAIgK,QACbjL,KAAOiB,IAAIgE,KAGb,KAAKjF,KACH,KAAOqK,OAASrK,MACdA,KAAOqK,KAAKpF,MACZoF,KAAOA,KAAKY,OAIhBD,GAAIA,GAAKxL,OAAO0L,MAGZ3D,WAAWyD,EAAG,mBAAkBA,EAAEG,cAAgBhJ,KAClDoF,WAAWyD,EAAG,YAAWA,EAAEzJ,OAASyJ,EAAEI,YACtC7D,WAAWyD,EAAG,WAAUA,EAAEK,MAAQL,EAAEM,UAAYN,EAAEO,SAEtDP,EAAEhL,KAAOA,KAGL+K,QAAQjB,KAAK7I,IAAK+J,MAAO,GAAS,cAAc/H,KAAKd,IAAIoE,QACvDyE,EAAEQ,gBAAgBR,EAAEQ,iBACxBR,EAAES,aAAc,GAGbT,EAAEU,gBACLjK,GAAKzB,KAAOyK,4BAA4BJ,MAAQpJ,IAChDQ,GAAGsD,WAcT,QAAS4G,UAASzI,KAAM0I,KAAMC,QACvB3I,OACLA,KAAKrB,aAAagK,OAAQD,MAC1B1I,KAAKY,YAAY8H,OAQnB,QAAS7G,QAAOkB,YAAahF,KAE3BE,KAAK8E,YAAa,SAASpG,KAAMS,GAE/B,GAAI6B,KAAMtC,KAAKsC,IACb2J,SAAWjM,KAAKyG,KAChBO,MAAQhE,KAAKhD,KAAKA,KAAMoB,KACxBmB,OAASvC,KAAKsC,IAAIgB,UAUpB,IARItD,KAAK8G,KACPE,QAAUA,MACQ,MAATA,QACTA,MAAQ,IAKNhH,KAAKgH,QAAUA,MAAnB,CAMA,GAHAhH,KAAKgH,MAAQA,OAGRiF,SAYH,MATAjF,QAAS,QAELzE,SACqB,aAAnBA,OAAOpB,SACToB,OAAOyE,MAAQA,MACVkF,aAAY5J,IAAIqE,UAAYK,QAE9B1E,IAAIqE,UAAYK,OAMzB,IAAiB,UAAbiF,SAEF,YADA3J,IAAI0E,MAAQA,MAQd,IAHAxE,QAAQF,IAAK2J,UAGT1C,WAAWvC,OACbiE,gBAAgBgB,SAAUjF,MAAO1E,IAAKlB,SAGjC,IAAgB,MAAZ6K,SAAkB,CAC3B,GAAI/H,MAAOlE,KAAKkE,KACdiI,IAAM,WAAaL,SAAS5H,KAAKZ,WAAYY,KAAM5B,MACnD8J,OAAS,WAAaN,SAASxJ,IAAIgB,WAAYhB,IAAK4B,MAGlD8C,OACE9C,OACFiI,MACA7J,IAAI+J,QAAS,EAGR/B,SAAShI,MACZyD,KAAKzD,IAAK,SAASV,IACbA,GAAG6G,OAAS7G,GAAG6G,KAAKC,YACtB9G,GAAG6G,KAAKC,YAAc9G,GAAG6G,KAAKM,QAAQ,cAM9C7E,KAAOlE,KAAKkE,KAAOA,MAAQV,SAASC,eAAe,IAE/CnB,IAAIgB,WACN8I,UAEIhL,IAAImB,QAAUnB,KAAK4C,IAAI,UAAWoI,QAExC9J,IAAI+J,QAAS,OAGO,SAAbJ,SACT3J,IAAIgK,MAAMC,QAAUvF,MAAQ,GAAK,OAEX,SAAbiF,SACT3J,IAAIgK,MAAMC,QAAUvF,MAAQ,OAAS,GAE5BhH,KAAK8G,MACdxE,IAAI2J,UAAYjF,MACZA,OAAOqD,QAAQ/H,IAAK2J,SAAUA,UAC9B3G,SAAwB,aAAb2G,UAA2C,WAAhB3J,IAAInB,UAC5CmB,IAAImD,WAAauB,SAGA,IAAVA,OAAeA,aAAgBA,SAAUvC,YAE9C+H,WAAWP,SAAUQ,cAAgBR,UAAYlB,WACnDkB,SAAWA,SAAStG,MAAM8G,YAAY/L,SAExC2J,QAAQ/H,IAAK2J,SAAUjF,WAY7B,QAAS1F,MAAKoL,IAAK1C,IAGjB,IAAK,GAAWpI,IAFZQ,IAAMsK,IAAMA,IAAIhM,OAAS,EAEpBD,EAAI,EAAOA,EAAI2B,IAAK3B,IAC3BmB,GAAK8K,IAAIjM,GAEC,MAANmB,IAAcoI,GAAGpI,GAAInB,MAAO,GAAOA,GAEzC,OAAOiM,KAQT,QAASnD,YAAWa,GAClB,aAAcA,KAAMuC,aAAc,EAQpC,QAAS1J,cAAarB,IACpB,GAAIA,GAAGgL,UAAW,MAAOhL,IAAGgL,SAG1B,IAAIC,WAAYC,KAAK,MAErB,OADAD,WAAU5K,YAAYL,GAAGmD,WAAU,IAC5B8H,UAAU7H,UASrB,QAAS+H,cAAaF,UAAWG,MAC/B,SAAWH,WAAU7H,WAAayC,QAASoF,UAAU7H,UAAYgI,SAE5D,CACH,GAAIC,MAAM,GAAIC,YAAYC,gBAAgBH,KAAM,kBAChDH,WAAU5K,YACR4K,UAAUO,cAAcC,WAAWJ,IAAIK,iBAAiB,KAU9D,QAASC,UAAS1G,MAChB,OAAQ2G,cAAc7I,QAAQkC,MAShC,QAASiC,UAASsB,GAChB,MAAOA,UAAYA,KAAM3F,SAQ3B,QAASjC,SAAQF,IAAKuE,MACpBvE,IAAImL,gBAAgB5G,MAQtB,QAASS,SAAQoG,QACf,MAAOA,QAAOC,QAAQ,SAAU,SAASC,EAAGC,GAC1C,MAAOA,GAAEC,gBAUb,QAASnL,SAAQL,IAAKuE,MACpB,MAAOvE,KAAIyL,aAAalH,MAS1B,QAASwD,SAAQ/H,IAAKuE,KAAM3G,KAC1BoC,IAAI0L,aAAanH,KAAM3G,KAQzB,QAASwD,QAAOpB,KACd,MAAOA,KAAInB,SAAW4B,UAAUJ,QAAQL,IAAKwI,cAC3CnI,QAAQL,IAAKyI,WAAazI,IAAInB,QAAQyC,eAQ1C,QAASqK,aAAY7M,IAAKD,QAASoB,QACjC,GAAI2L,WAAY3L,OAAOhC,KAAKY,QAGxB+M,YAGG7M,QAAQ6M,YAEPA,YAAc9M,MAChBmB,OAAOhC,KAAKY,UAAY+M,YAEvBnG,SAASxF,OAAOhC,KAAKY,SAAUC,MAClCmB,OAAOhC,KAAKY,SAASe,KAAKd,MAE5BmB,OAAOhC,KAAKY,SAAWC,IAU3B,QAASG,cAAaH,IAAKD,QAASgN,QAClC,GACE5N,MADEgC,OAASnB,IAAImB,MAGZA,UAELhC,KAAOgC,OAAOhC,KAAKY,SAEfE,QAAQd,MACVA,KAAKK,OAAOuN,OAAQ,EAAG5N,KAAKK,OAAOL,KAAKoE,QAAQvD,KAAM,GAAG,IACtD6M,YAAY7M,IAAKD,QAASoB,SAWjC,QAAS0D,cAAalF,MAAOsG,KAAMrC,UAAWzC,QAC5C,GAAInB,KAAM,GAAIwD,KAAI7D,MAAOsG,KAAMrC,WAC7B7D,QAAU0B,WAAWwE,KAAKhE,MAC1BmH,KAAOI,4BAA4BrI,OAiBrC,OAfAnB,KAAImB,OAASiI,KAIbpJ,IAAIgK,QAAU7I,OAGd0L,YAAY7M,IAAKD,QAASqJ,MAEtBA,OAASjI,QACX0L,YAAY7M,IAAKD,QAASoB,QAG5B8E,KAAKhE,KAAK2B,UAAY,GAEf5D,IAQT,QAASwJ,6BAA4BxJ,KAEnC,IADA,GAAIoJ,MAAOpJ,KACHsC,OAAO8G,KAAKnH,OACbmH,KAAKjI,QACViI,KAAOA,KAAKjI,MAEd,OAAOiI,MAWT,QAASnF,gBAAezD,GAAI3B,IAAK+G,MAAOoH,SAOtC,MANApN,QAAOqE,eAAezD,GAAI3B,IAAKuG,QAC7BQ,MAAOA,MACPqH,YAAY,EACZC,UAAU,EACVC,cAAc,GACbH,UACIxM,GAQT,QAASiB,YAAWP,KAClB,GAAIvB,OAAQ2C,OAAOpB,KACjBkM,SAAW7L,QAAQL,IAAK,QACxBnB,QAAUqN,WAAaxL,KAAKuD,QAAQiI,UACxBA,SACFzN,MAAQA,MAAM8F,KAAOvE,IAAInB,QAAQyC,aAE7C,OAAOzC,SAaT,QAASqF,QAAO/E,KAEd,IAAK,GADD2H,KAAKqF,KAAOxF,UACPxI,EAAI,EAAGA,EAAIgO,KAAK/N,SAAUD,EACjC,GAAI2I,IAAMqF,KAAKhO,GACb,IAAK,GAAIR,OAAOmJ,KAEV1B,WAAWjG,IAAKxB,OAClBwB,IAAIxB,KAAOmJ,IAAInJ,KAIvB,OAAOwB,KAST,QAASsG,UAAS2G,IAAKvO,MACrB,OAAQuO,IAAI/J,QAAQxE,MAQtB,QAASkB,SAAQsN,GAAK,MAAOC,OAAMvN,QAAQsN,IAAMA,YAAaC,OAQ9D,QAASlH,YAAW0B,IAAKnJ,KACvB,GAAIoJ,OAAQrI,OAAO6N,yBAAyBzF,IAAKnJ,IACjD,cAAcmJ,KAAInJ,OAASwH,SAAW4B,OAASA,MAAMiF,SASvD,QAAS9F,aAAYhB,MACnB,KAAMA,eAAgB5C,MAAU4C,YAAeA,MAAKuB,SAAW4D,YAC7D,MAAOnF,KAET,IAAIsH,KACJ,KAAK,GAAI7O,OAAOuH,MACTM,yBAAyB1E,KAAKnD,OAAM6O,EAAE7O,KAAOuH,KAAKvH,KAEzD,OAAO6O,GAQT,QAAS/I,MAAKzD,IAAK0H,IACjB,GAAI1H,IAAK,CAEP,GAAI0H,GAAG1H,QAAS,EAAO,MAIrB,KAFAA,IAAMA,IAAI2C,WAEH3C,KACLyD,KAAKzD,IAAK0H,IACV1H,IAAMA,IAAIP,aAWlB,QAASoI,gBAAe6C,KAAMhD,IAI5B,IAHA,GAAI+E,GACFC,GAAK,gDAEAD,EAAIC,GAAGC,KAAKjC,OACjBhD,GAAG+E,EAAE,GAAGnL,cAAemL,EAAE,IAAMA,EAAE,IAAMA,EAAE,IAS7C,QAASzE,UAAShI,KAChB,KAAOA,KAAK,CACV,GAAIA,IAAI+J,OAAQ,OAAO,CACvB/J,KAAMA,IAAIgB,WAEZ,OAAO,EAST,QAASwJ,MAAKjG,KAAMqI,OAClB,MAAOA,OACL1L,SAAS2L,gBAAgB,6BAA8B,OACvD3L,SAAS4L,cAAcvI,MAS3B,QAASwI,IAAGC,SAAUnI,KACpB,OAAQA,KAAO3D,UAAU+L,iBAAiBD,UAS5C,QAASE,GAAEF,SAAUnI,KACnB,OAAQA,KAAO3D,UAAUiM,cAAcH,UAQzC,QAAS/G,SAAQhG,QACf,QAASmN,UAET,MADAA,OAAMC,UAAYpN,OACX,GAAImN,OAQb,QAASE,aAAYtN,KACnB,MAAOK,SAAQL,IAAK,OAASK,QAAQL,IAAK,QAS5C,QAAS4D,UAAS5D,IAAKC,OAAQtB,MAE7B,GACE4O,OADE5P,IAAM2P,YAAYtN,KAGpB6J,IAAM,SAASnF,OAETe,SAAS9G,KAAMhB,OAEnB4P,MAAQxO,QAAQ2F,OAEXA,QAIK6I,OAASA,QAAU9H,SAASf,MAAO1E,QAEvCuN,MACF7I,MAAM9E,KAAKI,KAEXC,OAAOtC,MAAQ+G,MAAO1E,MAPxBC,OAAOtC,KAAOqC,KAYfrC,OAGD+C,KAAKuD,QAAQtG,KAEfsC,OAAOyB,IAAI,QAAS,WAClB/D,IAAM2P,YAAYtN,KAClB6J,IAAI5J,OAAOtC,QAGbkM,IAAI5J,OAAOtC,OAUf,QAASuM,YAAW/K,IAAKqO,KACvB,MAAOrO,KAAIkE,MAAM,EAAGmK,IAAIpP,UAAYoP,IA8BtC,QAASC,SAAQ1M,KAAMlC,QAASkG,MAC9B,GAAIjG,KAAM2B,UAAU5B,SAElB6D,UAAY3B,KAAK2M,WAAa3M,KAAK2M,YAAc3M,KAAK2B,SAaxD,OAVA3B,MAAK2B,UAAY,GAEb5D,KAAOiC,OAAMjC,IAAM,GAAIwD,KAAIxD,KAAOiC,KAAMA,KAAMgE,KAAMA,MAAQrC,YAE5D5D,KAAOA,IAAIvB,QACbuB,IAAIvB,QAECkI,SAAS4C,aAAcvJ,MAAMuJ,aAAazI,KAAKd,MAG/CA,IAj3ET,GAAI1B,OAASuQ,QAAS,SAAUC,aAK9BvH,MAAQ,EAERgC,gBAEA5H,aAKA+G,aAAe,iBAGf2C,YAAc,QACd1B,SAAW0B,YAAc,MACzB3B,YAAc,UAGdlI,SAAW,SACX6B,SAAW,SACXgD,QAAW,YACXkF,WAAa,WAEbxJ,mBAAqB,yEACrB2E,yBAA2B,oHAE3B0F,eAAiB,WAAY,UAAW,eAAgB,SAAU,WAAY,OAAQ,UAAW,UAAW,gBAAiB,sBAAuB,cAAe,mBAAoB,oBAAqB,oBAAqB,UAAW,iBAAkB,UAAW,UAAW,eAAgB,WAAY,qBAAsB,SAAU,eAAgB,SAAU,OAAQ,gBAAiB,IAAK,QAAS,WAAY,QAAS,OAAQ,iBAAkB,SAAU,OAAQ,gBAAiB,OAAQ,UAAW,UAAW,WAAY,iBAAkB,OAAQ,OAAQ,MAAO,SAAU,SAAU,OAAQ,WAAY,OAAQ,QAAS,OAG/mBtB,WAA8D,GAAhDvM,QAAUA,OAAO6D,cAAgB2M,aAG/C7K,QAAU3F,UAAYA,OAAOyQ,cAE/B1Q,MAAK2I,WAAa,SAASzG,IAwBzB,QAASyO,aAAYlF,EAAGnB,IAEtB,IADA,GAA6CnD,MAAMyJ,KAA/CC,GAAKpF,EAAEpE,MAAM,KAAMyJ,EAAID,GAAG7P,OAAQD,EAAI,EACnCA,EAAI+P,EAAG/P,IACZoG,KAAO0J,GAAG9P,GACV6P,KAAOzJ,KAAKlC,QAAQ,KAChBkC,MAAMmD,IAAKsG,KAAOzJ,KAAK4J,UAAU,EAAGH,MAAQzJ,KAAMpG,GAAI6P,KAAOzJ,KAAKlB,MAAM2K,KAAO,GAAK,MAtB5F1O,GAAKA,MAKL,IAAI8O,cACF/K,MAAQiJ,MAAMe,UAAUhK,KA2I1B,OAlHA3E,QAAO2P,iBAAiB/O,IAQtBuC,IACE6C,MAAO,SAAS4J,OAAQ5G,IACtB,MAAiB,kBAANA,IAA0BpI,IAErCyO,YAAYO,OAAQ,SAAS/J,KAAMzG,IAAKyQ,KACrCH,UAAU7J,MAAQ6J,UAAU7J,WAAa3E,KAAK8H,IAC/CA,GAAG8G,MAAQ1Q,IAAM,EACjB4J,GAAG6G,GAAKA,KAGHjP,KAETyM,YAAY,EACZC,UAAU,EACVC,cAAc,GAShBvD,KACEhE,MAAO,SAAS4J,OAAQ5G,IAYtB,MAXc,KAAV4G,QAAkB5G,GAEpBqG,YAAYO,OAAQ,SAAS/J,KAAMzG,IAAKyQ,IACtC,GAAI7G,IAAM6G,GAER,IAAK,GAAWE,IADZrC,IAAMgC,UAAU7J,MACXpG,EAAI,EAAOsQ,GAAKrC,KAAOA,IAAIjO,KAAMA,GACpCsQ,IAAM/G,IAAM6G,IAAME,GAAGF,IAAMA,KAAInC,IAAI9N,OAAOH,IAAK,cAEzCiQ,WAAU7J,QARF6J,aAWnB9O,IAETyM,YAAY,EACZC,UAAU,EACVC,cAAc,GAUhBvK,KACEgD,MAAO,SAAS4J,OAAQ5G,IACtB,QAAS7F,MACPvC,GAAGoJ,IAAI4F,OAAQzM,IACf6F,GAAGgH,MAAMpP,GAAIqH,WAEf,MAAOrH,IAAGuC,GAAGyM,OAAQzM,KAEvBkK,YAAY,EACZC,UAAU,EACVC,cAAc,GAShBxF,SACE/B,MAAO,SAAS4J,QAOd,IAAK,GAFHK,KAFEC,OAASjI,UAAUvI,OAAS,EAC9B+N,KAAO,GAAIG,OAAMsC,QAGVzQ,EAAI,EAAGA,EAAIyQ,OAAQzQ,IAC1BgO,KAAKhO,GAAKwI,UAAUxI,EAAI,EAoB1B,OAjBA4P,aAAYO,OAAQ,SAAS/J,KAAMzG,IAAKyQ,IAEtCI,IAAMtL,MAAMsE,KAAKyG,UAAU7J,UAAa,EAExC,KAAK,GAAWmD,IAAPvJ,EAAI,EAAOuJ,GAAKiH,IAAIxQ,KAAMA,EAC7BuJ,GAAGmH,OACPnH,GAAGmH,KAAO,EACLN,IAAM7G,GAAG6G,IAAMA,IAAI7G,GAAGgH,MAAMpP,GAAIoI,GAAG8G,OAASjK,MAAM2C,OAAOiF,MAAQA,MAClEwC,IAAIxQ,KAAOuJ,IAAMvJ,IACrBuJ,GAAGmH,KAAO,EAGRT,WAAU,MAAgB,KAAR7J,MACpBjF,GAAGmH,QAAQiI,MAAMpP,IAAK,IAAKiF,MAAM2C,OAAOiF,SAIrC7M,IAETyM,YAAY,EACZC,UAAU,EACVC,cAAc,KAIX3M,IAIR,SAAUlC,MAmCX,QAAS0R,gBAAeC,MACtB,MAAOA,MAAKtK,MAAM,UASpB,QAASuK,uBAAsBD,KAAME,QACnC,GAAIvC,IAAK,GAAIwC,QAAO,IAAMD,OAAOE,SAAS,MAAO,cAAcA,SAAS,OAAQ,MAAQ,KACtFhD,KAAO4C,KAAKK,MAAM1C,GAEpB,IAAIP,KAAM,MAAOA,MAAK9I,MAAM,GAS9B,QAASgM,UAAS3H,GAAI4H,OACpB,GAAIpR,EACJ,OAAO,YACLqR,aAAarR,GACbA,EAAIsR,WAAW9H,GAAI4H,QAQvB,QAASG,OAAMC,UACbC,cAAgBN,SAASO,KAAM,GAC/BC,IAAIC,oBAAoBC,SAAUJ,eAClCE,IAAIC,oBAAoBE,WAAYL,eACpChF,IAAImF,oBAAoBG,WAAYC,OAChCR,UAAUE,MAAK,GAMrB,QAASO,UACPnK,KAAKkH,KACL9P,KAAK2I,WAAWC,MAChBoK,QAAQvO,GAAG,OAAQmE,KAAKqK,EAAEhJ,KAAKrB,OAC/BoK,QAAQvO,GAAG,OAAQmE,KAAK6C,EAAExB,KAAKrB,OAGjC,QAASsK,WAAUvB,MACjB,MAAOA,MAAKI,SAAS,UAAW,IAGlC,QAASoB,UAAS/C,KAChB,MAAqB,gBAAPA,KAQhB,QAASgD,iBAAgBC,MACvB,OAAQA,MAAQC,IAAID,MAAMtB,SAASwB,UAAW,IAQhD,QAASC,iBAAgBH,MACvB,MAAkB,KAAXI,KAAK,IACPJ,MAAQC,IAAID,MAAQ,IAAIhM,MAAMoM,MAAM,IAAM,IAC1CH,IAAMF,gBAAgBC,MAAQA,MAAQ,IAAItB,SAAS0B,KAAM,IAGhE,QAASjB,MAAKkB,OAEZ,GAAIC,QAA2B,GAAlBC,cACb,MAAIC,sBAAwBD,kBAE5BA,iBACAE,UAAUtR,KAAK,WACb,GAAImP,MAAO6B,mBACPE,OAAS/B,MAAQoC,WACnBf,QAAQgB,SAAS,OAAQrC,MACzBoC,QAAUpC,QAGVgC,QAAQ,CACV,KAAOG,UAAU9S,QACf8S,UAAU,KACVA,UAAUG,OAEZL,gBAAiB,GAIrB,QAASd,OAAMrH,GACb,KACa,GAAXA,EAAEK,OACCL,EAAEyI,SAAWzI,EAAE0I,SAAW1I,EAAE2I,UAC5B3I,EAAE4I,kBAHP,CAOA,IADA,GAAInS,IAAKuJ,EAAEzJ,OACJE,IAAqB,KAAfA,GAAGoS,UAAiBpS,GAAKA,GAAG0B,YAGtC1B,IAAqB,KAAfA,GAAGoS,UACPpS,GAAGqS,eAAe,cACjBrS,GAAGqS,eAAe,SACnBrS,GAAGF,QAAuB,SAAbE,GAAGF,QAChBE,GAAGmR,KAAKpO,QAAQqO,IAAID,KAAKrB,MAAMuB,WAAW,MAAO,IAGlDrR,GAAGmR,MAAQC,IAAID,MAEfnR,GAAGmR,KAAKhM,MAAM,KAAK,IAAMiM,IAAID,KAAKhM,MAAM,KAAK,KAClC,KAARoM,MAA0D,IAA3CL,gBAAgBlR,GAAGmR,MAAMpO,QAAQwO,QAC/Ce,GAAGhB,gBAAgBtR,GAAGmR,MAAOnR,GAAGuS,OAASlH,IAAIkH,SAIrDhJ,EAAEQ,kBAUJ,QAASuI,IAAG7C,KAAM8C,MAAOC,eACvB,MAAIC,OACFhD,KAAO8B,KAAOP,UAAUvB,MACxB8C,MAAQA,OAASlH,IAAIkH,MAErBC,cACIC,KAAKC,aAAa,KAAMH,MAAO9C,MAC/BgD,KAAKE,UAAU,KAAMJ,MAAO9C,MAEhCpE,IAAIkH,MAAQA,MACZK,YAAa,EACbtC,OACOsC,YAIF9B,QAAQgB,SAAS,OAAQR,gBAAgB7B,OAtLlD,GAmBEY,eACAkB,KAAMM,QAASgB,OAAQC,aApBrBzB,UAAY,kBACd0B,eAAiB,gBACjBC,sBAAwB,SAAWD,eACnCvC,mBAAqB,MAAQuC,eAC7BV,cAAgB,eAChBxC,QAAU,UACVY,SAAW,WACXC,WAAa,aACboB,QAAU,UACVH,qBAAuB,EACvBpB,IAAuB,mBAAVxS,SAAyBA,OACtCsN,IAAyB,mBAAZzJ,WAA2BA,SACxC6Q,KAAOlC,KAAO0C,QACd7B,IAAMb,MAAQkC,KAAKS,UAAY3C,IAAI2C,UACnCC,KAAOtC,OAAO9C,UACd4C,WAAatF,KAAOA,IAAI+H,aAAe,aAAe,QACtDC,SAAU,EACVvC,QAAUhT,KAAK2I,aACfmM,YAAa,EAEwBhB,aAAgBF,eAAiB,CAgLxEyB,MAAKhG,EAAI,SAASmG,MAAOC,OAAQC,QAC3BvC,SAASqC,QAAYC,SAAUtC,SAASsC,QACnCA,OAAQ7M,KAAK+M,EAAEH,MAAOC,QAC1B7M,KAAK+M,EAAE,IAAKH,OAFqChB,GAAGgB,MAAOC,OAAQC,QAAS,IAQnFL,KAAKpC,EAAI,WACPrK,KAAK0C,IAAI,KACT1C,KAAKkH,MAOPuF,KAAK5J,EAAI,SAASkG,MAChB/I,KAAKkH,EAAEhG,OAAO,KAAK8L,KAAK,SAAS/D,QAC/B,GAAI9C,OAAkB,KAAV8C,OAAgBkD,OAASC,cAAc9B,UAAUvB,MAAOuB,UAAUrB,QAC9E,IAAmB,mBAAR9C,MAET,MADAnG,MAAKoL,SAAS1C,MAAM,MAAOO,QAAQ/H,OAAOiF,OACnC+F,YAAa,GAErBlM,OAQLyM,KAAKM,EAAI,SAAS9D,OAAQgE,QACV,KAAVhE,SACFA,OAAS,IAAMqB,UAAUrB,QACzBjJ,KAAKkH,EAAEtN,KAAKqP,SAEdjJ,KAAKnE,GAAGoN,OAAQgE,QAGlB,IAAIC,YAAa,GAAI/C,QACjBgD,MAAQD,WAAWzG,EAAEpF,KAAK6L,WAM9BC,OAAMC,OAAS,WACb,GAAIC,cAAe,GAAIlD,QAEnBmD,OAASD,aAAa5G,EAAEpF,KAAKgM,aAGjC,OADAC,QAAOC,KAAOF,aAAahD,EAAEhJ,KAAKgM,cAC3BC,QAOTH,MAAMtC,KAAO,SAAS2C,KACpB3C,KAAO2C,KAAO,IACdrC,QAAUP,mBAIZuC,MAAMxG,KAAO,WACXiD,MAAK,IAQPuD,MAAMhB,OAAS,SAASzK,GAAI+L,KACrB/L,IAAO+L,MAEVtB,OAASrD,eACTsD,aAAepD,uBAEbtH,KAAIyK,OAASzK,IACb+L,MAAKrB,aAAeqB,MAO1BN,MAAMO,MAAQ,WACZ,GAAIC,MACAlD,KAAOC,IAAID,MAAQU,OAEvB,OADAV,MAAKtB,SAAS,qBAAsB,SAAS7D,EAAGhG,EAAGwC,GAAK6L,EAAErO,GAAKwC,IACxD6L,GAITR,MAAMI,KAAO,WACPZ,UACE9C,MACFA,IAAIyC,uBAAuBvC,SAAUJ,eACrCE,IAAIyC,uBAAuBtC,WAAYL,eACvChF,IAAI2H,uBAAuBrC,WAAYC,QAEzCE,QAAQgB,SAAS,QACjBuB,SAAU,IAQdQ,MAAM1D,MAAQ,SAAUC,UACjBiD,UACC9C,MACyB,YAAvB3O,SAAS0S,WAA0BnE,MAAMC,UAGxCG,IAAIC,oBAAoB,OAAQ,WACnCN,WAAW,WAAaC,MAAMC,WAAa,MAG/CiD,SAAU,IAKdQ,MAAMtC,OACNsC,MAAMhB,SAEN/U,KAAK+V,MAAQA,OACV/V,KAgBH,IAAIyW,UAAW,SAAWC,OAuCxB,QAASC,WAAWrH,IAAM,MAAOA,IAEjC,QAASsH,UAAUtH,GAAIuH,IAErB,MADKA,MAAIA,GAAKC,QACP,GAAIhF,QACTxC,GAAGyH,OAAO9I,QAAQ,KAAM4I,GAAG,IAAI5I,QAAQ,KAAM4I,GAAG,IAAKvH,GAAG0H,OAASC,OAAS,IAI9E,QAASC,SAASC,MAChB,GAAIA,OAASC,QAAS,MAAOC,OAE7B,IAAIrI,KAAMmI,KAAK9P,MAAM,IAErB,IAAmB,IAAf2H,IAAIhO,QAAgB,+BAA+B0C,KAAKyT,MAC1D,KAAM,IAAIG,OAAM,yBAA2BH,KAAO,IASpD,OAPAnI,KAAMA,IAAIlF,OAAOqN,KAAKlJ,QAAQ,sBAAuB,MAAM5G,MAAM,MAEjE2H,IAAI,GAAK4H,SAAS5H,IAAI,GAAGhO,OAAS,EAAI,aAAeqW,OAAO,GAAIrI,KAChEA,IAAI,GAAK4H,SAASO,KAAKnW,OAAS,EAAI,WAAaqW,OAAO,GAAIrI,KAC5DA,IAAI,GAAK4H,SAASS,OAAO,GAAIrI,KAC7BA,IAAI,GAAK8C,OAAO,QAAU9C,IAAI,GAAK,cAAgBA,IAAI,GAAK,KAAOuI,UAAWN,QAC9EjI,IAAI,GAAKmI,KACFnI,IAGT,QAASwI,WAAWC,SAClB,MAAOA,mBAAmB3F,QAAS4F,OAAOD,SAAWX,OAAOW,SAqF9D,QAASE,QAAQR,OACVA,OAASA,KAAOC,YAAcN,OAAO,KACxCA,OAASI,QAAQC,MACjBO,OAASP,OAASC,QAAUT,UAAYC,SACxCE,OAAO,GAAKY,OAAOL,OAAO,KAE5BO,eAAiBT,KAGnB,QAASU,cAAczI,GACrB,GAAI0I,EAEJ1I,GAAIA,MACJ0I,EAAI1I,EAAEqH,SACNnV,OAAOqE,eAAeyJ,EAAG,YACvB2I,IAAKJ,OACLK,IAAK,WAAc,MAAOJ,iBAC1BjJ,YAAY,IAEdsJ,UAAY7I,EACZuI,OAAOG,GA1KT,GAiCEJ,QAEAO,UAlCAhB,OAAS,IAETiB,UAAY,qCAEZC,UAAY,+DAEZZ,UAAYY,UAAUpB,OAAS,IAC7B,wDAAwDA,OAAS,IACjE,8EAA8EA,OAEhFqB,YACEC,IAAKvG,OAAO,UAAcyF,UAAWN,QACrCqB,IAAKxG,OAAO,YAAcyF,UAAWN,QACrCsB,IAAKzG,OAAO,UAAcyF,UAAWN,SAGvCG,QAAU,MAERC,QACF,IAAK,IACL,IAAK,IACL,UACA,YACA,WACAvF,OAAO,uBAAyByF,UAAWN,QAC3CG,QACA,yDACA,wBAIAQ,eAAiBlB,MAEjBI,SAwJF,OAtHAU,WAAUnQ,MAAQ,SAAgB+I,IAAK9M,KAAMkV,KA2C3C,QAASC,aAAaxF,GAChB3P,MAAQoV,OACVC,MAAMnW,KAAKyQ,GAAKA,EAAEhF,QAAQuK,IAAI,GAAI,OAElCG,MAAMnW,KAAKyQ,GAIf,QAAS2F,YAAY3F,EAAG4F,GAAIC,IAC1B,GACE9G,OACA+G,MAAQX,WAAWS,GAIrB,KAFAE,MAAMC,UAAYF,GAClBA,GAAK,GACG9G,MAAQ+G,MAAMxJ,KAAK0D,OACrBjB,MAAM,KACNA,MAAM,KAAO6G,KAAOC,KAAOA,OAEjC,MAAOA,IAAK7F,EAAEjS,OAAS+X,MAAMC,UA5D1BR,MAAKA,IAAM1B,OAEhB,IAEE9E,OACA0G,OACArG,MACA3R,IAJAiY,SAKArJ,GAAKkJ,IAAI,EAIX,KAFAE,OAASrG,MAAQ/C,GAAG0J,UAAY,EAExBhH,MAAQ1C,GAAGC,KAAKa,MAAO,CAI7B,GAFA1P,IAAMsR,MAAMiH,MAERP,OAAQ,CAEV,GAAI1G,MAAM,GAAI,CACZ1C,GAAG0J,UAAYJ,WAAWxI,IAAK4B,MAAM,GAAI1C,GAAG0J,UAC5C,UAEF,IAAKhH,MAAM,GACT,SAICA,MAAM,KACTyG,YAAYrI,IAAInK,MAAMoM,MAAO3R,MAC7B2R,MAAQ/C,GAAG0J,UACX1J,GAAKkJ,IAAI,GAAKE,QAAU,IACxBpJ,GAAG0J,UAAY3G,OAQnB,MAJIjC,MAAOiC,MAAQjC,IAAIpP,QACrByX,YAAYrI,IAAInK,MAAMoM,QAGjBsG,OAyBTnB,UAAU3Q,QAAU,SAAkBuJ,KACpC,MAAO0G,QAAO,GAAGpT,KAAK0M,MAGxBoH,UAAUnT,SAAW,SAAmB/D,MACtC,GAAI+O,GAAI/O,KAAK0R,MAAM8E,OAAO,GAE1B,OAAOzH,IACD9O,IAAK8O,EAAE,GAAI3O,IAAK2O,EAAE,GAAI7O,IAAKsW,OAAO,GAAKzH,EAAE,GAAG6J,OAASpC,OAAO,KAC5DtW,IAAKF,KAAK4Y,SAGlB1B,UAAU2B,MAAQ,SAAgBhC,MAChC,MAAOA,MAAOD,QAAQC,MAAQL,QA0BhCxV,OAAOqE,eAAe6R,UAAW,YAC/BO,IAAKF,aACLG,IAAK,WAAc,MAAOC,cAI5BT,UAAUhH,SAA2B,mBAATxQ,OAAwBA,KAAKwQ,aACzDgH,UAAUO,IAAMJ,OAEhBH,UAAUW,UAAYA,UACtBX,UAAUU,UAAYA,UACtBV,UAAUD,UAAYA,UAEfC,aAYLlU,KAAO,WAIT,QAAS8V,OAAOhJ,IAAKtI,MACnB,MAAKsI,MAEG0G,OAAO1G,OAAS0G,OAAO1G,KAAO8G,QAAQ9G,OAAO7F,KAAKzC,KAAMuR,SAF/CjJ,IAanB,QAASiJ,SAASC,IAAK7R,KAEjB2R,MAAMG,eAERD,IAAIE,UACF/X,QAASgG,KAAOA,IAAI9D,MAAQ8D,IAAI9D,KAAKlC,QACrC0J,SAAU1D,KAAOA,IAAI0D,UAEvBiO,MAAMG,aAAaD,MAIvB,QAASpC,SAAS9G,KAChB,GAAI9P,MAAOmZ,SAASrJ,IAMpB,OAJ0B,gBAAtB9P,KAAK2F,MAAM,EAAG,MAAuB3F,KAAO,UAAYA,MAIrD,GAAIoZ,UAAS,IAAKpZ,KAAO,KAWlC,QAASmZ,UAAUrJ,KACjB,GAEE9P,MADAqZ,QAEAhB,MAAQlC,SAASpP,MAAM+I,IAAInC,QAAQ2L,UAAW,KAAM,EAEtD,IAAIjB,MAAM3X,OAAS,GAAK2X,MAAM,GAAI,CAChC,GAAI5X,GAAGE,EAAG4Y,OAEV,KAAK9Y,EAAIE,EAAI,EAAGF,EAAI4X,MAAM3X,SAAUD,EAElCT,KAAOqY,MAAM5X,GAETT,OAASA,KAAW,EAAJS,EAEd+Y,WAAWxZ,KAAM,EAAGqZ,MAEpB,IAAMrZ,KACH2N,QAAQ,MAAO,QACfA,QAAQ,YAAa,OACrBA,QAAQ,KAAM,OACjB,OAED4L,KAAK5Y,KAAOX,KAInBA,MAAOW,EAAI,EAAI4Y,KAAK,GACb,IAAMA,KAAKE,KAAK,KAAO,iBAI9BzZ,MAAOwZ,WAAWnB,MAAM,GAAI,EAAGgB,KAUjC,OAPIA,MAAK,KACPrZ,KAAOA,KAAK2N,QAAQ+L,UAAW,SAAU9L,EAAGxN,KAC1C,MAAOiZ,MAAKjZ,KACTuN,QAAQ,MAAO,OACfA,QAAQ,MAAO,UAGf3N,KAUT,QAASwZ,YAAYxZ,KAAM2Z,OAAQN,MAwCjC,QAASf,YAAYC,GAAIvJ,IACvB,GACE4K,IACAC,GAAK,EACLC,GAAKC,SAASxB,GAGhB,KADAuB,GAAGpB,UAAY1J,GAAG0J,UACXkB,GAAKE,GAAG7K,KAAKjP,OAClB,GAAI4Z,GAAG,KAAOrB,KAAMsB,OACf,OAAOA,GAAI,KAElB7K,IAAG0J,UAAYmB,GAAK7Z,KAAKU,OAASoZ,GAAGpB,UA1CvC,GAPA1Y,KAAOA,KACA2N,QAAQqM,UAAW,SAAUrH,EAAGsH,KAC/B,MAAOtH,GAAEjS,OAAS,IAAMuZ,IAAMC,WAAab,KAAKnX,KAAKyQ,GAAK,GAAK,IAAMA,IAEtEhF,QAAQ,OAAQ,KAAKiL,OACrBjL,QAAQ,wBAAyB,MAE9B,CAMR,IALA,GAGE+D,OAFA6H,QACAY,IAAM,EAGDna,OACA0R,MAAQ1R,KAAK0R,MAAM0I,cACnB1I,MAAMiH,OACT,CACF,GACE1Y,KACAoa,IACArL,GAAK,cAKP,KAHAhP,KAAOwR,OAAO8I,aACdra,IAAOyR,MAAM,GAAK2H,KAAK3H,MAAM,IAAI/L,MAAM,GAAG,GAAIiT,OAAOjL,QAAQ,OAAQ,KAAO+D,MAAM,GAE3E2I,KAAO3I,MAAQ1C,GAAGC,KAAKjP,OAAO,IAAIsY,WAAW+B,IAAKrL,GAEzDqL,KAAOra,KAAK2F,MAAM,EAAG+L,MAAMiH,OAC3B3Y,KAAOwR,OAAO8I,aAEdf,KAAKY,OAASI,UAAUF,IAAK,EAAGpa,KAGlCD,KAAQma,IACDA,IAAM,EAAI,IAAMZ,KAAKE,KAAK,KAAO,qBAAuBF,KAAK,GADtDgB,UAAUva,KAAM2Z,QAGhC,MAAO3Z,MAuBT,QAASua,WAAWva,KAAM2Z,OAAQ1Z,KAChC,GAAIua,GAiCJ,OA/BAxa,MAAOA,KAAK2N,QAAQ8M,WAAY,SAAU/I,MAAOjH,EAAGiQ,KAAMta,IAAKuS,GAW7D,MAVI+H,QACFta,IAAMoa,GAAK,EAAIpa,IAAMsR,MAAMhR,OAEd,SAATga,MAA4B,WAATA,MAA8B,WAATA,MAC1ChJ,MAAQjH,EAAI,KAAOiQ,KAAOC,WAAaD,KACnCta,MAAKoa,GAAsB,OAAhB7H,EAAIA,EAAEvS,OAAuB,MAANuS,GAAmB,MAANA,IAC1CvS,MACToa,IAAMI,WAAWxX,KAAKuP,EAAEhN,MAAMvF,QAG3BsR,QAGL8I,KACFxa,KAAO,cAAgBA,KAAO,wBAG5BC,IAEFD,MAAQwa,GACF,cAAgBxa,KAAO,eAAiB,IAAMA,KAAO,KACrD,KAAOC,IAAM,OAEV0Z,SAET3Z,KAAO,gBAAkBwa,GACnBxa,KAAK2N,QAAQ,UAAW,MAAQ,MAAQ3N,KAAO,KAC/C,qCAGDA,KAjMT,GAAIwW,UAQJsC,OAAM+B,QAAU1E,SAAS2E,OAEzBhC,MAAMvS,QAAU4P,SAAS5P,QAEzBuS,MAAM/U,SAAWoS,SAASpS,SAE1B+U,MAAMG,aAAe,IAyBrB,IACEiB,WAAY,IACZE,UAAY,2DACZJ,UAAYxI,OAAO2E,SAASc,UAAW,KACvCqC,UAAY,UACZI,UAAY,gBAgDZK,UACEhC,IAAK,QACLC,IAAK,SACLC,IAAK,SA4DP0C,WAAa,kBAAsC,gBAAXhb,QAAsB,SAAW,UAAY,KACrF8a,WAAa,8JACbG,WAAa,+BA4Cf,OAJA9B,OAAMiC,MAAQ,SAAUpI,GAAK,MAAOA,IAEpCmG,MAAM7I,QAAUkG,SAASlG,QAAU,SAE5B6I,SAWLlQ,MAAQ,QAAUoS,UAoBpB,QAASA,QAAOC,MAAOjO,MACrB,GACE0E,OAAUuJ,OAASA,MAAMvJ,MAAM,iBAC/BvQ,QAAUuQ,OAASA,MAAM,GAAG9N,cAC5BhC,GAAKkL,KAAK,MAAOS,SAASpM,SAa5B,OAVA8Z,OAAQC,aAAaD,MAAOjO,MAGxBmO,QAAQ/X,KAAKjC,SACfS,GAAKwZ,YAAYxZ,GAAIqZ,MAAO9Z,SAE5B4L,aAAanL,GAAIqZ,OAEnBrZ,GAAGsC,MAAO,EAEHtC,GAOT,QAASwZ,aAAYxZ,GAAIqZ,MAAO9Z,SAC9B,GACEka,QAAwB,MAAfla,QAAQ,GACjBoB,OAAS8Y,OAAS,UAAY,QAShC,IALAzZ,GAAGoD,UAAY,IAAMzC,OAAS0Y,MAAMrC,OAAS,KAAOrW,OACpDA,OAASX,GAAGqD,WAIRoW,OACF9Y,OAAOmD,eAAgB,MAClB,CAEL,GAAI4V,OAAQC,QAAQpa,QAChBma,QAAsC,IAA7B/Y,OAAOiZ,oBAAyBjZ,OAASiN,EAAE8L,MAAO/Y,SAEjE,MAAOA,QAOT,QAAS2Y,cAAaD,MAAOjO,MAE3B,IAAKyO,WAAWrY,KAAK6X,OAAQ,MAAOA,MAGpC,IAAIxZ,OAOJ,OALAuL,MAAOA,MAAQA,KAAKW,QAAQ+N,WAAY,SAAU9N,EAAGrK,IAAKoY,MAExD,MADAla,KAAI8B,KAAO9B,IAAI8B,MAAQoY,KAChB,KACN/C,OAEIqC,MACJtN,QAAQiO,YAAa,SAAUhO,EAAGrK,IAAKsY,KACtC,MAAOpa,KAAI8B,MAAQsY,KAAO,KAE3BlO,QAAQmO,WAAY,SAAUlO,EAAGiO,KAChC,MAAO7O,OAAQ6O,KAAO,KAtF5B,GACEJ,YAAc,YACdK,WAAc,+CACdJ,WAAc,4DACdE,YAAc,uEAEdL,SAAYQ,GAAI,QAASC,GAAI,KAAMC,GAAI,KAAMC,IAAK,YAClDf,QAAUjP,YAAcA,WAAa,GACjC/I,mBAAqB,uDAkF3B,OAAO6X,WAuQLmB,aAAe,SAAUC,OAE3B,IAAKzc,OAAQ,OACXwM,IAAK,aACLkQ,OAAQ,aAGV,IAAIC,WAAY,WAEd,GAAIC,SAAUzP,KAAK,QACnBzC,SAAQkS,QAAS,OAAQ,WAGzB,IAAIC,UAAWhN,EAAE,mBAOjB,OANIgN,WACEA,SAASC,KAAIF,QAAQE,GAAKD,SAASC,IACvCD,SAASlZ,WAAWoZ,aAAaH,QAASC,WAEvChZ,SAASmZ,qBAAqB,QAAQ,GAAG1a,YAAYsa,SAEnDA,WAILK,YAAcN,UAAUO,WAC1BC,eAAiB,EAWnB,OARA9b,QAAOqE,eAAe+W,MAAO,aAC3BpV,MAAOsV,UACPhO,UAAU,KAWVnC,IAAK,SAAS4Q,KACZD,gBAAkBC,KAMpBV,OAAQ,WACFS,iBACEF,YAAaA,YAAYI,SAAWF,eACnCR,UAAUtX,WAAa8X,eAC5BA,eAAiB,OAKtBpd,MA8+BCsJ,IAAM,SAAWiU,GACnB,GAAIC,KAAMD,EAAEE,uBACFF,EAAEG,0BAA4BH,EAAEI,2BAE1C,KAAKH,KAAO,uBAAuB9Z,KAAK6Z,EAAEK,UAAUC,WAAY,CAC9D,GAAIC,UAAW,CAEfN,KAAM,SAAUnM,IACd,GAAI0M,SAAUC,KAAKC,MAAOC,QAAUC,KAAKC,IAAI,IAAML,QAAUD,UAAW,EACxE1L,YAAW,WAAcf,GAAGyM,SAAWC,QAAUG,UAAYA,UAGjE,MAAOV,MAENvd,WAgCHD,MAAKqe,MAAS5H,SAAUA,SAAUnT,KAAMA,MAKxCtD,KAAK4J,MAAQ,WACX,GAAI0U,WACFC,QAAUD,OAAOlU,iBACjBoU,IAAM,CASR,OAAO,UAASrX,KAAMyC,MAAO6U,GAE3B,GAAIrV,SAASjC,MAEX,WADAnH,MAAK4J,MAAM,aAAa4U,MAAOrX,MAAM,EAIvC,IAAIuX,OAAQD,EAAIF,QAAUD,MAG1B,KAAK1U,MAAO,CACV,SAAW8U,OAAMvX,QAAUY,QACzB,KAAM,IAAIuP,OAAM,uBAAyBnQ,KAE3C,OAAOuX,OAAMvX,MAGX0C,WAAWD,QACb9C,OAAO8C,MAAMqG,UAAWyO,MAAMvX,WAC9BuX,MAAMvX,MAAQyC,OAGd8U,MAAMvX,MAAQL,OAAO4X,MAAMvX,UAAayC,WAe9C5J,KAAK0B,IAAM,SAASyF,KAAMmG,KAAM+P,IAAK7S,MAAOF,IAc1C,MAbIT,YAAWW,SACbF,GAAKE,MACD,eAAe9G,KAAK2Z,MACtB7S,MAAQ6S,IACRA,IAAM,IACD7S,MAAQ,IAEb6S,MACExT,WAAWwT,KAAM/S,GAAK+S,IACrBZ,aAAahQ,IAAI4Q,MAExBlW,KAAOA,KAAKjD,cACZb,UAAU8D,OAAUA,KAAMA,KAAM7D,KAAMgK,KAAM9C,MAAOA,MAAOF,GAAIA,IACvDnD,MAYTnH,KAAK2e,KAAO,SAASxX,KAAMmG,KAAM+P,IAAK7S,MAAOF,IAI3C,MAHI+S,MAAKZ,aAAahQ,IAAI4Q,KAE1Bha,UAAU8D,OAAUA,KAAMA,KAAM7D,KAAMgK,KAAM9C,MAAOA,MAAOF,GAAIA,IACvDnD,MAUTnH,KAAKG,MAAQ,SAASyP,SAAUnO,QAASkG,MAQvC,QAASiX,aAAY5P,KACnB,GAAI6K,MAAO,EAOX,OANAjY,MAAKoN,IAAK,SAAUvD,GACb,SAAS/H,KAAK+H,KACjBA,EAAIA,EAAEyN,OAAOhV,cACb2V,MAAQ,KAAOzO,YAAc,KAAOK,EAAI,OAASJ,SAAW,KAAOI,EAAI,QAGpEoO,KAGT,QAASgF,iBACP,GAAItd,MAAOD,OAAOC,KAAK8B,UACvB,OAAO9B,MAAOqd,YAAYrd,MAG5B,QAASud,UAASnb,MAChB,GAAIA,KAAKlC,QAAS,CAChB,GAAIsd,SAAU9b,QAAQU,KAAMyH,cAAgBnI,QAAQU,KAAM0H,SAGtD5J,UAAWsd,UAAYtd,UACzBsd,QAAUtd,QACVkJ,QAAQhH,KAAMyH,YAAa3J,SAC3BkJ,QAAQhH,KAAM0H,SAAU5J,SAE1B,IAAIC,KAAM2O,QAAQ1M,KAAMob,SAAWpb,KAAKlC,QAAQyC,cAAeyD,KAE3DjG,MAAKb,KAAK2B,KAAKd,SACViC,MAAK3C,QACdY,KAAK+B,KAAMmb,UApCf,GAAI9R,KACFgS,QACAne,OAmEF,IA1BA4b,aAAaE,SAETvT,SAAS3H,WACXkG,KAAOlG,QACPA,QAAU,SAIDmO,YAAa1M,UACL,MAAb0M,SAGFA,SAAWoP,QAAUH,gBAGrBjP,UAAYgP,YAAYhP,SAASvI,MAAM,QAIzC2F,IAAM4C,SAAWD,GAAGC,cAIpB5C,IAAM4C,SAGQ,MAAZnO,QAAiB,CAInB,GAFAA,QAAUud,SAAWH,gBAEjB7R,IAAIvL,QACNuL,IAAM2C,GAAGlO,QAASuL,SACf,CAEH,GAAIiS,YACJrd,MAAKoL,IAAK,SAAUkS,KAClBD,SAASzc,KAAKmN,GAAGlO,QAASyd,QAE5BlS,IAAMiS,SAGRxd,QAAU,EAKZ,MAFAqd,UAAS9R,KAEFnM,MAOTb,KAAKwF,OAAS;AACZ,MAAO5D,MAAKqJ,aAAc,SAASvJ,KACjCA,IAAI8D,YAORxF,KAAKmf,KAAOlU,aAKZjL,KAAKkF,IAAMA,UAGEka,WAAYra,SACrBsa,OAAOD,QAAUpf,WACHsf,UAAWrS,kBAAqBqS,QAAOC,MAAQxX,QAC7DuX,OAAO,WAAa,MAAOtf,QAE3BC,OAAOD,KAAOA,MAEE,mBAAVC,QAAwBA,OAAS","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","window.riot = riot = require 'riot'\nrequire './tags/app.tag'\nrequire './tags/board.tag'\nrequire './tags/note.tag'\n\nriot.mount 'app'","/* Riot v2.5.0, @license MIT */\n\n;(function(window, undefined) {\n  'use strict';\nvar riot = { version: 'v2.5.0', settings: {} },\n  // be aware, internal usage\n  // ATTENTION: prefix the global dynamic variables with `__`\n\n  // counter to give a unique id to all the Tag instances\n  __uid = 0,\n  // tags instances cache\n  __virtualDom = [],\n  // tags implementation cache\n  __tagImpl = {},\n\n  /**\n   * Const\n   */\n  GLOBAL_MIXIN = '__global_mixin',\n\n  // riot specific prefixes\n  RIOT_PREFIX = 'riot-',\n  RIOT_TAG = RIOT_PREFIX + 'tag',\n  RIOT_TAG_IS = 'data-is',\n\n  // for typeof == '' comparisons\n  T_STRING = 'string',\n  T_OBJECT = 'object',\n  T_UNDEF  = 'undefined',\n  T_FUNCTION = 'function',\n  // special native tags that cannot be treated like the others\n  SPECIAL_TAGS_REGEX = /^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/,\n  RESERVED_WORDS_BLACKLIST = /^(?:_(?:item|id|parent)|update|root|(?:un)?mount|mixin|is(?:Mounted|Loop)|tags|parent|opts|trigger|o(?:n|ff|ne))$/,\n  // SVG tags list https://www.w3.org/TR/SVG/attindex.html#PresentationAttributes\n  SVG_TAGS_LIST = ['altGlyph', 'animate', 'animateColor', 'circle', 'clipPath', 'defs', 'ellipse', 'feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feFlood', 'feGaussianBlur', 'feImage', 'feMerge', 'feMorphology', 'feOffset', 'feSpecularLighting', 'feTile', 'feTurbulence', 'filter', 'font', 'foreignObject', 'g', 'glyph', 'glyphRef', 'image', 'line', 'linearGradient', 'marker', 'mask', 'missing-glyph', 'path', 'pattern', 'polygon', 'polyline', 'radialGradient', 'rect', 'stop', 'svg', 'switch', 'symbol', 'text', 'textPath', 'tref', 'tspan', 'use'],\n\n  // version# for IE 8-11, 0 for others\n  IE_VERSION = (window && window.document || {}).documentMode | 0,\n\n  // detect firefox to fix #1374\n  FIREFOX = window && !!window.InstallTrigger\n/* istanbul ignore next */\nriot.observable = function(el) {\n\n  /**\n   * Extend the original object or create a new empty one\n   * @type { Object }\n   */\n\n  el = el || {}\n\n  /**\n   * Private variables\n   */\n  var callbacks = {},\n    slice = Array.prototype.slice\n\n  /**\n   * Private Methods\n   */\n\n  /**\n   * Helper function needed to get and loop all the events in a string\n   * @param   { String }   e - event string\n   * @param   {Function}   fn - callback\n   */\n  function onEachEvent(e, fn) {\n    var es = e.split(' '), l = es.length, i = 0, name, indx\n    for (; i < l; i++) {\n      name = es[i]\n      indx = name.indexOf('.')\n      if (name) fn( ~indx ? name.substring(0, indx) : name, i, ~indx ? name.slice(indx + 1) : null)\n    }\n  }\n\n  /**\n   * Public Api\n   */\n\n  // extend the el object adding the observable methods\n  Object.defineProperties(el, {\n    /**\n     * Listen to the given space separated list of `events` and\n     * execute the `callback` each time an event is triggered.\n     * @param  { String } events - events ids\n     * @param  { Function } fn - callback function\n     * @returns { Object } el\n     */\n    on: {\n      value: function(events, fn) {\n        if (typeof fn != 'function')  return el\n\n        onEachEvent(events, function(name, pos, ns) {\n          (callbacks[name] = callbacks[name] || []).push(fn)\n          fn.typed = pos > 0\n          fn.ns = ns\n        })\n\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Removes the given space separated list of `events` listeners\n     * @param   { String } events - events ids\n     * @param   { Function } fn - callback function\n     * @returns { Object } el\n     */\n    off: {\n      value: function(events, fn) {\n        if (events == '*' && !fn) callbacks = {}\n        else {\n          onEachEvent(events, function(name, pos, ns) {\n            if (fn || ns) {\n              var arr = callbacks[name]\n              for (var i = 0, cb; cb = arr && arr[i]; ++i) {\n                if (cb == fn || ns && cb.ns == ns) arr.splice(i--, 1)\n              }\n            } else delete callbacks[name]\n          })\n        }\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Listen to the given space separated list of `events` and\n     * execute the `callback` at most once\n     * @param   { String } events - events ids\n     * @param   { Function } fn - callback function\n     * @returns { Object } el\n     */\n    one: {\n      value: function(events, fn) {\n        function on() {\n          el.off(events, on)\n          fn.apply(el, arguments)\n        }\n        return el.on(events, on)\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    },\n\n    /**\n     * Execute all callback functions that listen to\n     * the given space separated list of `events`\n     * @param   { String } events - events ids\n     * @returns { Object } el\n     */\n    trigger: {\n      value: function(events) {\n\n        // getting the arguments\n        var arglen = arguments.length - 1,\n          args = new Array(arglen),\n          fns\n\n        for (var i = 0; i < arglen; i++) {\n          args[i] = arguments[i + 1] // skip first argument\n        }\n\n        onEachEvent(events, function(name, pos, ns) {\n\n          fns = slice.call(callbacks[name] || [], 0)\n\n          for (var i = 0, fn; fn = fns[i]; ++i) {\n            if (fn.busy) continue\n            fn.busy = 1\n            if (!ns || fn.ns == ns) fn.apply(el, fn.typed ? [name].concat(args) : args)\n            if (fns[i] !== fn) { i-- }\n            fn.busy = 0\n          }\n\n          if (callbacks['*'] && name != '*')\n            el.trigger.apply(el, ['*', name].concat(args))\n\n        })\n\n        return el\n      },\n      enumerable: false,\n      writable: false,\n      configurable: false\n    }\n  })\n\n  return el\n\n}\n/* istanbul ignore next */\n;(function(riot) {\n\n/**\n * Simple client-side router\n * @module riot-route\n */\n\n\nvar RE_ORIGIN = /^.+?\\/\\/+[^\\/]+/,\n  EVENT_LISTENER = 'EventListener',\n  REMOVE_EVENT_LISTENER = 'remove' + EVENT_LISTENER,\n  ADD_EVENT_LISTENER = 'add' + EVENT_LISTENER,\n  HAS_ATTRIBUTE = 'hasAttribute',\n  REPLACE = 'replace',\n  POPSTATE = 'popstate',\n  HASHCHANGE = 'hashchange',\n  TRIGGER = 'trigger',\n  MAX_EMIT_STACK_LEVEL = 3,\n  win = typeof window != 'undefined' && window,\n  doc = typeof document != 'undefined' && document,\n  hist = win && history,\n  loc = win && (hist.location || win.location), // see html5-history-api\n  prot = Router.prototype, // to minify more\n  clickEvent = doc && doc.ontouchstart ? 'touchstart' : 'click',\n  started = false,\n  central = riot.observable(),\n  routeFound = false,\n  debouncedEmit,\n  base, current, parser, secondParser, emitStack = [], emitStackLevel = 0\n\n/**\n * Default parser. You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_PARSER(path) {\n  return path.split(/[/?#]/)\n}\n\n/**\n * Default parser (second). You can replace it via router.parser method.\n * @param {string} path - current path (normalized)\n * @param {string} filter - filter string (normalized)\n * @returns {array} array\n */\nfunction DEFAULT_SECOND_PARSER(path, filter) {\n  var re = new RegExp('^' + filter[REPLACE](/\\*/g, '([^/?#]+?)')[REPLACE](/\\.\\./, '.*') + '$'),\n    args = path.match(re)\n\n  if (args) return args.slice(1)\n}\n\n/**\n * Simple/cheap debounce implementation\n * @param   {function} fn - callback\n * @param   {number} delay - delay in seconds\n * @returns {function} debounced function\n */\nfunction debounce(fn, delay) {\n  var t\n  return function () {\n    clearTimeout(t)\n    t = setTimeout(fn, delay)\n  }\n}\n\n/**\n * Set the window listeners to trigger the routes\n * @param {boolean} autoExec - see route.start\n */\nfunction start(autoExec) {\n  debouncedEmit = debounce(emit, 1)\n  win[ADD_EVENT_LISTENER](POPSTATE, debouncedEmit)\n  win[ADD_EVENT_LISTENER](HASHCHANGE, debouncedEmit)\n  doc[ADD_EVENT_LISTENER](clickEvent, click)\n  if (autoExec) emit(true)\n}\n\n/**\n * Router class\n */\nfunction Router() {\n  this.$ = []\n  riot.observable(this) // make it observable\n  central.on('stop', this.s.bind(this))\n  central.on('emit', this.e.bind(this))\n}\n\nfunction normalize(path) {\n  return path[REPLACE](/^\\/|\\/$/, '')\n}\n\nfunction isString(str) {\n  return typeof str == 'string'\n}\n\n/**\n * Get the part after domain name\n * @param {string} href - fullpath\n * @returns {string} path from root\n */\nfunction getPathFromRoot(href) {\n  return (href || loc.href)[REPLACE](RE_ORIGIN, '')\n}\n\n/**\n * Get the part after base\n * @param {string} href - fullpath\n * @returns {string} path from base\n */\nfunction getPathFromBase(href) {\n  return base[0] == '#'\n    ? (href || loc.href || '').split(base)[1] || ''\n    : (loc ? getPathFromRoot(href) : href || '')[REPLACE](base, '')\n}\n\nfunction emit(force) {\n  // the stack is needed for redirections\n  var isRoot = emitStackLevel == 0\n  if (MAX_EMIT_STACK_LEVEL <= emitStackLevel) return\n\n  emitStackLevel++\n  emitStack.push(function() {\n    var path = getPathFromBase()\n    if (force || path != current) {\n      central[TRIGGER]('emit', path)\n      current = path\n    }\n  })\n  if (isRoot) {\n    while (emitStack.length) {\n      emitStack[0]()\n      emitStack.shift()\n    }\n    emitStackLevel = 0\n  }\n}\n\nfunction click(e) {\n  if (\n    e.which != 1 // not left click\n    || e.metaKey || e.ctrlKey || e.shiftKey // or meta keys\n    || e.defaultPrevented // or default prevented\n  ) return\n\n  var el = e.target\n  while (el && el.nodeName != 'A') el = el.parentNode\n\n  if (\n    !el || el.nodeName != 'A' // not A tag\n    || el[HAS_ATTRIBUTE]('download') // has download attr\n    || !el[HAS_ATTRIBUTE]('href') // has no href attr\n    || el.target && el.target != '_self' // another window or frame\n    || el.href.indexOf(loc.href.match(RE_ORIGIN)[0]) == -1 // cross origin\n  ) return\n\n  if (el.href != loc.href) {\n    if (\n      el.href.split('#')[0] == loc.href.split('#')[0] // internal jump\n      || base != '#' && getPathFromRoot(el.href).indexOf(base) !== 0 // outside of base\n      || !go(getPathFromBase(el.href), el.title || doc.title) // route not found\n    ) return\n  }\n\n  e.preventDefault()\n}\n\n/**\n * Go to the path\n * @param {string} path - destination path\n * @param {string} title - page title\n * @param {boolean} shouldReplace - use replaceState or pushState\n * @returns {boolean} - route not found flag\n */\nfunction go(path, title, shouldReplace) {\n  if (hist) { // if a browser\n    path = base + normalize(path)\n    title = title || doc.title\n    // browsers ignores the second parameter `title`\n    shouldReplace\n      ? hist.replaceState(null, title, path)\n      : hist.pushState(null, title, path)\n    // so we need to set it manually\n    doc.title = title\n    routeFound = false\n    emit()\n    return routeFound\n  }\n\n  // Server-side usage: directly execute handlers for the path\n  return central[TRIGGER]('emit', getPathFromBase(path))\n}\n\n/**\n * Go to path or set action\n * a single string:                go there\n * two strings:                    go there with setting a title\n * two strings and boolean:        replace history with setting a title\n * a single function:              set an action on the default route\n * a string/RegExp and a function: set an action on the route\n * @param {(string|function)} first - path / action / filter\n * @param {(string|RegExp|function)} second - title / action\n * @param {boolean} third - replace flag\n */\nprot.m = function(first, second, third) {\n  if (isString(first) && (!second || isString(second))) go(first, second, third || false)\n  else if (second) this.r(first, second)\n  else this.r('@', first)\n}\n\n/**\n * Stop routing\n */\nprot.s = function() {\n  this.off('*')\n  this.$ = []\n}\n\n/**\n * Emit\n * @param {string} path - path\n */\nprot.e = function(path) {\n  this.$.concat('@').some(function(filter) {\n    var args = (filter == '@' ? parser : secondParser)(normalize(path), normalize(filter))\n    if (typeof args != 'undefined') {\n      this[TRIGGER].apply(null, [filter].concat(args))\n      return routeFound = true // exit from loop\n    }\n  }, this)\n}\n\n/**\n * Register route\n * @param {string} filter - filter for matching to url\n * @param {function} action - action to register\n */\nprot.r = function(filter, action) {\n  if (filter != '@') {\n    filter = '/' + normalize(filter)\n    this.$.push(filter)\n  }\n  this.on(filter, action)\n}\n\nvar mainRouter = new Router()\nvar route = mainRouter.m.bind(mainRouter)\n\n/**\n * Create a sub router\n * @returns {function} the method of a new Router object\n */\nroute.create = function() {\n  var newSubRouter = new Router()\n  // assign sub-router's main method\n  var router = newSubRouter.m.bind(newSubRouter)\n  // stop only this sub-router\n  router.stop = newSubRouter.s.bind(newSubRouter)\n  return router\n}\n\n/**\n * Set the base of url\n * @param {(str|RegExp)} arg - a new base or '#' or '#!'\n */\nroute.base = function(arg) {\n  base = arg || '#'\n  current = getPathFromBase() // recalculate current path\n}\n\n/** Exec routing right now **/\nroute.exec = function() {\n  emit(true)\n}\n\n/**\n * Replace the default router to yours\n * @param {function} fn - your parser function\n * @param {function} fn2 - your secondParser function\n */\nroute.parser = function(fn, fn2) {\n  if (!fn && !fn2) {\n    // reset parser for testing...\n    parser = DEFAULT_PARSER\n    secondParser = DEFAULT_SECOND_PARSER\n  }\n  if (fn) parser = fn\n  if (fn2) secondParser = fn2\n}\n\n/**\n * Helper function to get url query as an object\n * @returns {object} parsed query\n */\nroute.query = function() {\n  var q = {}\n  var href = loc.href || current\n  href[REPLACE](/[?&](.+?)=([^&]*)/g, function(_, k, v) { q[k] = v })\n  return q\n}\n\n/** Stop routing **/\nroute.stop = function () {\n  if (started) {\n    if (win) {\n      win[REMOVE_EVENT_LISTENER](POPSTATE, debouncedEmit)\n      win[REMOVE_EVENT_LISTENER](HASHCHANGE, debouncedEmit)\n      doc[REMOVE_EVENT_LISTENER](clickEvent, click)\n    }\n    central[TRIGGER]('stop')\n    started = false\n  }\n}\n\n/**\n * Start routing\n * @param {boolean} autoExec - automatically exec after starting if true\n */\nroute.start = function (autoExec) {\n  if (!started) {\n    if (win) {\n      if (document.readyState == 'complete') start(autoExec)\n      // the timeout is needed to solve\n      // a weird safari bug https://github.com/riot/route/issues/33\n      else win[ADD_EVENT_LISTENER]('load', function() {\n        setTimeout(function() { start(autoExec) }, 1)\n      })\n    }\n    started = true\n  }\n}\n\n/** Prepare the router **/\nroute.base()\nroute.parser()\n\nriot.route = route\n})(riot)\n/* istanbul ignore next */\n\n/**\n * The riot template engine\n * @version v2.4.0\n */\n/**\n * riot.util.brackets\n *\n * - `brackets    ` - Returns a string or regex based on its parameter\n * - `brackets.set` - Change the current riot brackets\n *\n * @module\n */\n\nvar brackets = (function (UNDEF) {\n\n  var\n    REGLOB = 'g',\n\n    R_MLCOMMS = /\\/\\*[^*]*\\*+(?:[^*\\/][^*]*\\*+)*\\//g,\n\n    R_STRINGS = /\"[^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*'/g,\n\n    S_QBLOCKS = R_STRINGS.source + '|' +\n      /(?:\\breturn\\s+|(?:[$\\w\\)\\]]|\\+\\+|--)\\s*(\\/)(?![*\\/]))/.source + '|' +\n      /\\/(?=[^*\\/])[^[\\/\\\\]*(?:(?:\\[(?:\\\\.|[^\\]\\\\]*)*\\]|\\\\.)[^[\\/\\\\]*)*?(\\/)[gim]*/.source,\n\n    FINDBRACES = {\n      '(': RegExp('([()])|'   + S_QBLOCKS, REGLOB),\n      '[': RegExp('([[\\\\]])|' + S_QBLOCKS, REGLOB),\n      '{': RegExp('([{}])|'   + S_QBLOCKS, REGLOB)\n    },\n\n    DEFAULT = '{ }'\n\n  var _pairs = [\n    '{', '}',\n    '{', '}',\n    /{[^}]*}/,\n    /\\\\([{}])/g,\n    /\\\\({)|{/g,\n    RegExp('\\\\\\\\(})|([[({])|(})|' + S_QBLOCKS, REGLOB),\n    DEFAULT,\n    /^\\s*{\\^?\\s*([$\\w]+)(?:\\s*,\\s*(\\S+))?\\s+in\\s+(\\S.*)\\s*}/,\n    /(^|[^\\\\]){=[\\S\\s]*?}/\n  ]\n\n  var\n    cachedBrackets = UNDEF,\n    _regex,\n    _cache = [],\n    _settings\n\n  function _loopback (re) { return re }\n\n  function _rewrite (re, bp) {\n    if (!bp) bp = _cache\n    return new RegExp(\n      re.source.replace(/{/g, bp[2]).replace(/}/g, bp[3]), re.global ? REGLOB : ''\n    )\n  }\n\n  function _create (pair) {\n    if (pair === DEFAULT) return _pairs\n\n    var arr = pair.split(' ')\n\n    if (arr.length !== 2 || /[\\x00-\\x1F<>a-zA-Z0-9'\",;\\\\]/.test(pair)) { // eslint-disable-line\n      throw new Error('Unsupported brackets \"' + pair + '\"')\n    }\n    arr = arr.concat(pair.replace(/(?=[[\\]()*+?.^$|])/g, '\\\\').split(' '))\n\n    arr[4] = _rewrite(arr[1].length > 1 ? /{[\\S\\s]*?}/ : _pairs[4], arr)\n    arr[5] = _rewrite(pair.length > 3 ? /\\\\({|})/g : _pairs[5], arr)\n    arr[6] = _rewrite(_pairs[6], arr)\n    arr[7] = RegExp('\\\\\\\\(' + arr[3] + ')|([[({])|(' + arr[3] + ')|' + S_QBLOCKS, REGLOB)\n    arr[8] = pair\n    return arr\n  }\n\n  function _brackets (reOrIdx) {\n    return reOrIdx instanceof RegExp ? _regex(reOrIdx) : _cache[reOrIdx]\n  }\n\n  _brackets.split = function split (str, tmpl, _bp) {\n    // istanbul ignore next: _bp is for the compiler\n    if (!_bp) _bp = _cache\n\n    var\n      parts = [],\n      match,\n      isexpr,\n      start,\n      pos,\n      re = _bp[6]\n\n    isexpr = start = re.lastIndex = 0\n\n    while ((match = re.exec(str))) {\n\n      pos = match.index\n\n      if (isexpr) {\n\n        if (match[2]) {\n          re.lastIndex = skipBraces(str, match[2], re.lastIndex)\n          continue\n        }\n        if (!match[3]) {\n          continue\n        }\n      }\n\n      if (!match[1]) {\n        unescapeStr(str.slice(start, pos))\n        start = re.lastIndex\n        re = _bp[6 + (isexpr ^= 1)]\n        re.lastIndex = start\n      }\n    }\n\n    if (str && start < str.length) {\n      unescapeStr(str.slice(start))\n    }\n\n    return parts\n\n    function unescapeStr (s) {\n      if (tmpl || isexpr) {\n        parts.push(s && s.replace(_bp[5], '$1'))\n      } else {\n        parts.push(s)\n      }\n    }\n\n    function skipBraces (s, ch, ix) {\n      var\n        match,\n        recch = FINDBRACES[ch]\n\n      recch.lastIndex = ix\n      ix = 1\n      while ((match = recch.exec(s))) {\n        if (match[1] &&\n          !(match[1] === ch ? ++ix : --ix)) break\n      }\n      return ix ? s.length : recch.lastIndex\n    }\n  }\n\n  _brackets.hasExpr = function hasExpr (str) {\n    return _cache[4].test(str)\n  }\n\n  _brackets.loopKeys = function loopKeys (expr) {\n    var m = expr.match(_cache[9])\n\n    return m\n      ? { key: m[1], pos: m[2], val: _cache[0] + m[3].trim() + _cache[1] }\n      : { val: expr.trim() }\n  }\n\n  _brackets.array = function array (pair) {\n    return pair ? _create(pair) : _cache\n  }\n\n  function _reset (pair) {\n    if ((pair || (pair = DEFAULT)) !== _cache[8]) {\n      _cache = _create(pair)\n      _regex = pair === DEFAULT ? _loopback : _rewrite\n      _cache[9] = _regex(_pairs[9])\n    }\n    cachedBrackets = pair\n  }\n\n  function _setSettings (o) {\n    var b\n\n    o = o || {}\n    b = o.brackets\n    Object.defineProperty(o, 'brackets', {\n      set: _reset,\n      get: function () { return cachedBrackets },\n      enumerable: true\n    })\n    _settings = o\n    _reset(b)\n  }\n\n  Object.defineProperty(_brackets, 'settings', {\n    set: _setSettings,\n    get: function () { return _settings }\n  })\n\n  /* istanbul ignore next: in the browser riot is always in the scope */\n  _brackets.settings = typeof riot !== 'undefined' && riot.settings || {}\n  _brackets.set = _reset\n\n  _brackets.R_STRINGS = R_STRINGS\n  _brackets.R_MLCOMMS = R_MLCOMMS\n  _brackets.S_QBLOCKS = S_QBLOCKS\n\n  return _brackets\n\n})()\n\n/**\n * @module tmpl\n *\n * tmpl          - Root function, returns the template value, render with data\n * tmpl.hasExpr  - Test the existence of a expression inside a string\n * tmpl.loopKeys - Get the keys for an 'each' loop (used by `_each`)\n */\n\nvar tmpl = (function () {\n\n  var _cache = {}\n\n  function _tmpl (str, data) {\n    if (!str) return str\n\n    return (_cache[str] || (_cache[str] = _create(str))).call(data, _logErr)\n  }\n\n  _tmpl.haveRaw = brackets.hasRaw\n\n  _tmpl.hasExpr = brackets.hasExpr\n\n  _tmpl.loopKeys = brackets.loopKeys\n\n  _tmpl.errorHandler = null\n\n  function _logErr (err, ctx) {\n\n    if (_tmpl.errorHandler) {\n\n      err.riotData = {\n        tagName: ctx && ctx.root && ctx.root.tagName,\n        _riot_id: ctx && ctx._riot_id  //eslint-disable-line camelcase\n      }\n      _tmpl.errorHandler(err)\n    }\n  }\n\n  function _create (str) {\n    var expr = _getTmpl(str)\n\n    if (expr.slice(0, 11) !== 'try{return ') expr = 'return ' + expr\n\n/* eslint-disable */\n\n    return new Function('E', expr + ';')\n/* eslint-enable */\n  }\n\n  var\n    CH_IDEXPR = '\\u2057',\n    RE_CSNAME = /^(?:(-?[_A-Za-z\\xA0-\\xFF][-\\w\\xA0-\\xFF]*)|\\u2057(\\d+)~):/,\n    RE_QBLOCK = RegExp(brackets.S_QBLOCKS, 'g'),\n    RE_DQUOTE = /\\u2057/g,\n    RE_QBMARK = /\\u2057(\\d+)~/g\n\n  function _getTmpl (str) {\n    var\n      qstr = [],\n      expr,\n      parts = brackets.split(str.replace(RE_DQUOTE, '\"'), 1)\n\n    if (parts.length > 2 || parts[0]) {\n      var i, j, list = []\n\n      for (i = j = 0; i < parts.length; ++i) {\n\n        expr = parts[i]\n\n        if (expr && (expr = i & 1\n\n            ? _parseExpr(expr, 1, qstr)\n\n            : '\"' + expr\n                .replace(/\\\\/g, '\\\\\\\\')\n                .replace(/\\r\\n?|\\n/g, '\\\\n')\n                .replace(/\"/g, '\\\\\"') +\n              '\"'\n\n          )) list[j++] = expr\n\n      }\n\n      expr = j < 2 ? list[0]\n           : '[' + list.join(',') + '].join(\"\")'\n\n    } else {\n\n      expr = _parseExpr(parts[1], 0, qstr)\n    }\n\n    if (qstr[0]) {\n      expr = expr.replace(RE_QBMARK, function (_, pos) {\n        return qstr[pos]\n          .replace(/\\r/g, '\\\\r')\n          .replace(/\\n/g, '\\\\n')\n      })\n    }\n    return expr\n  }\n\n  var\n    RE_BREND = {\n      '(': /[()]/g,\n      '[': /[[\\]]/g,\n      '{': /[{}]/g\n    }\n\n  function _parseExpr (expr, asText, qstr) {\n\n    expr = expr\n          .replace(RE_QBLOCK, function (s, div) {\n            return s.length > 2 && !div ? CH_IDEXPR + (qstr.push(s) - 1) + '~' : s\n          })\n          .replace(/\\s+/g, ' ').trim()\n          .replace(/\\ ?([[\\({},?\\.:])\\ ?/g, '$1')\n\n    if (expr) {\n      var\n        list = [],\n        cnt = 0,\n        match\n\n      while (expr &&\n            (match = expr.match(RE_CSNAME)) &&\n            !match.index\n        ) {\n        var\n          key,\n          jsb,\n          re = /,|([[{(])|$/g\n\n        expr = RegExp.rightContext\n        key  = match[2] ? qstr[match[2]].slice(1, -1).trim().replace(/\\s+/g, ' ') : match[1]\n\n        while (jsb = (match = re.exec(expr))[1]) skipBraces(jsb, re)\n\n        jsb  = expr.slice(0, match.index)\n        expr = RegExp.rightContext\n\n        list[cnt++] = _wrapExpr(jsb, 1, key)\n      }\n\n      expr = !cnt ? _wrapExpr(expr, asText)\n           : cnt > 1 ? '[' + list.join(',') + '].join(\" \").trim()' : list[0]\n    }\n    return expr\n\n    function skipBraces (ch, re) {\n      var\n        mm,\n        lv = 1,\n        ir = RE_BREND[ch]\n\n      ir.lastIndex = re.lastIndex\n      while (mm = ir.exec(expr)) {\n        if (mm[0] === ch) ++lv\n        else if (!--lv) break\n      }\n      re.lastIndex = lv ? expr.length : ir.lastIndex\n    }\n  }\n\n  // istanbul ignore next: not both\n  var // eslint-disable-next-line max-len\n    JS_CONTEXT = '\"in this?this:' + (typeof window !== 'object' ? 'global' : 'window') + ').',\n    JS_VARNAME = /[,{][$\\w]+:|(^ *|[^$\\w\\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\\w]))([$_A-Za-z][$\\w]*)/g,\n    JS_NOPROPS = /^(?=(\\.[$\\w]+))\\1(?:[^.[(]|$)/\n\n  function _wrapExpr (expr, asText, key) {\n    var tb\n\n    expr = expr.replace(JS_VARNAME, function (match, p, mvar, pos, s) {\n      if (mvar) {\n        pos = tb ? 0 : pos + match.length\n\n        if (mvar !== 'this' && mvar !== 'global' && mvar !== 'window') {\n          match = p + '(\"' + mvar + JS_CONTEXT + mvar\n          if (pos) tb = (s = s[pos]) === '.' || s === '(' || s === '['\n        } else if (pos) {\n          tb = !JS_NOPROPS.test(s.slice(pos))\n        }\n      }\n      return match\n    })\n\n    if (tb) {\n      expr = 'try{return ' + expr + '}catch(e){E(e,this)}'\n    }\n\n    if (key) {\n\n      expr = (tb\n          ? 'function(){' + expr + '}.call(this)' : '(' + expr + ')'\n        ) + '?\"' + key + '\":\"\"'\n\n    } else if (asText) {\n\n      expr = 'function(v){' + (tb\n          ? expr.replace('return ', 'v=') : 'v=(' + expr + ')'\n        ) + ';return v||v===0?v:\"\"}.call(this)'\n    }\n\n    return expr\n  }\n\n  // istanbul ignore next: compatibility fix for beta versions\n  _tmpl.parse = function (s) { return s }\n\n  _tmpl.version = brackets.version = 'v2.4.0'\n\n  return _tmpl\n\n})()\n\n/*\n  lib/browser/tag/mkdom.js\n\n  Includes hacks needed for the Internet Explorer version 9 and below\n  See: http://kangax.github.io/compat-table/es5/#ie8\n       http://codeplanet.io/dropping-ie8/\n*/\nvar mkdom = (function _mkdom() {\n  var\n    reHasYield  = /<yield\\b/i,\n    reYieldAll  = /<yield\\s*(?:\\/>|>([\\S\\s]*?)<\\/yield\\s*>|>)/ig,\n    reYieldSrc  = /<yield\\s+to=['\"]([^'\">]*)['\"]\\s*>([\\S\\s]*?)<\\/yield\\s*>/ig,\n    reYieldDest = /<yield\\s+from=['\"]?([-\\w]+)['\"]?\\s*(?:\\/>|>([\\S\\s]*?)<\\/yield\\s*>)/ig\n  var\n    rootEls = { tr: 'tbody', th: 'tr', td: 'tr', col: 'colgroup' },\n    tblTags = IE_VERSION && IE_VERSION < 10\n      ? SPECIAL_TAGS_REGEX : /^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/\n\n  /**\n   * Creates a DOM element to wrap the given content. Normally an `DIV`, but can be\n   * also a `TABLE`, `SELECT`, `TBODY`, `TR`, or `COLGROUP` element.\n   *\n   * @param   {string} templ  - The template coming from the custom tag definition\n   * @param   {string} [html] - HTML content that comes from the DOM element where you\n   *           will mount the tag, mostly the original tag in the page\n   * @returns {HTMLElement} DOM element with _templ_ merged through `YIELD` with the _html_.\n   */\n  function _mkdom(templ, html) {\n    var\n      match   = templ && templ.match(/^\\s*<([-\\w]+)/),\n      tagName = match && match[1].toLowerCase(),\n      el = mkEl('div', isSVGTag(tagName))\n\n    // replace all the yield tags with the tag inner html\n    templ = replaceYield(templ, html)\n\n    /* istanbul ignore next */\n    if (tblTags.test(tagName))\n      el = specialTags(el, templ, tagName)\n    else\n      setInnerHTML(el, templ)\n\n    el.stub = true\n\n    return el\n  }\n\n  /*\n    Creates the root element for table or select child elements:\n    tr/th/td/thead/tfoot/tbody/caption/col/colgroup/option/optgroup\n  */\n  function specialTags(el, templ, tagName) {\n    var\n      select = tagName[0] === 'o',\n      parent = select ? 'select>' : 'table>'\n\n    // trim() is important here, this ensures we don't have artifacts,\n    // so we can check if we have only one element inside the parent\n    el.innerHTML = '<' + parent + templ.trim() + '</' + parent\n    parent = el.firstChild\n\n    // returns the immediate parent if tr/th/td/col is the only element, if not\n    // returns the whole tree, as this can include additional elements\n    if (select) {\n      parent.selectedIndex = -1  // for IE9, compatible w/current riot behavior\n    } else {\n      // avoids insertion of cointainer inside container (ex: tbody inside tbody)\n      var tname = rootEls[tagName]\n      if (tname && parent.childElementCount === 1) parent = $(tname, parent)\n    }\n    return parent\n  }\n\n  /*\n    Replace the yield tag from any tag template with the innerHTML of the\n    original tag in the page\n  */\n  function replaceYield(templ, html) {\n    // do nothing if no yield\n    if (!reHasYield.test(templ)) return templ\n\n    // be careful with #1343 - string on the source having `$1`\n    var src = {}\n\n    html = html && html.replace(reYieldSrc, function (_, ref, text) {\n      src[ref] = src[ref] || text   // preserve first definition\n      return ''\n    }).trim()\n\n    return templ\n      .replace(reYieldDest, function (_, ref, def) {  // yield with from - to attrs\n        return src[ref] || def || ''\n      })\n      .replace(reYieldAll, function (_, def) {        // yield without any \"from\"\n        return html || def || ''\n      })\n  }\n\n  return _mkdom\n\n})()\n\n/**\n * Convert the item looped into an object used to extend the child tag properties\n * @param   { Object } expr - object containing the keys used to extend the children tags\n * @param   { * } key - value to assign to the new object returned\n * @param   { * } val - value containing the position of the item in the array\n * @returns { Object } - new object containing the values of the original item\n *\n * The variables 'key' and 'val' are arbitrary.\n * They depend on the collection type looped (Array, Object)\n * and on the expression used on the each tag\n *\n */\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n/**\n * Unmount the redundant tags\n * @param   { Array } items - array containing the current items to loop\n * @param   { Array } tags - array containing all the children tags\n */\nfunction unmountRedundant(items, tags) {\n\n  var i = tags.length,\n    j = items.length,\n    t\n\n  while (i > j) {\n    t = tags[--i]\n    tags.splice(i, 1)\n    t.unmount()\n  }\n}\n\n/**\n * Move the nested custom tags in non custom loop tags\n * @param   { Object } child - non custom loop tag\n * @param   { Number } i - current position of the loop tag\n */\nfunction moveNestedTags(child, i) {\n  Object.keys(child.tags).forEach(function(tagName) {\n    var tag = child.tags[tagName]\n    if (isArray(tag))\n      each(tag, function (t) {\n        moveChildTag(t, tagName, i)\n      })\n    else\n      moveChildTag(tag, tagName, i)\n  })\n}\n\n/**\n * Adds the elements for a virtual tag\n * @param { Tag } tag - the tag whose root's children will be inserted or appended\n * @param { Node } src - the node that will do the inserting or appending\n * @param { Tag } target - only if inserting, insert before this tag's first child\n */\nfunction addVirtual(tag, src, target) {\n  var el = tag._root, sib\n  tag._virts = []\n  while (el) {\n    sib = el.nextSibling\n    if (target)\n      src.insertBefore(el, target._root)\n    else\n      src.appendChild(el)\n\n    tag._virts.push(el) // hold for unmounting\n    el = sib\n  }\n}\n\n/**\n * Move virtual tag and all child nodes\n * @param { Tag } tag - first child reference used to start move\n * @param { Node } src  - the node that will do the inserting\n * @param { Tag } target - insert before this tag's first child\n * @param { Number } len - how many child nodes to move\n */\nfunction moveVirtual(tag, src, target, len) {\n  var el = tag._root, sib, i = 0\n  for (; i < len; i++) {\n    sib = el.nextSibling\n    src.insertBefore(el, target._root)\n    el = sib\n  }\n}\n\n\n/**\n * Manage tags having the 'each'\n * @param   { Object } dom - DOM node we need to loop\n * @param   { Tag } parent - parent tag instance where the dom node is contained\n * @param   { String } expr - string contained in the 'each' attribute\n */\nfunction _each(dom, parent, expr) {\n\n  // remove the each property from the original tag\n  remAttr(dom, 'each')\n\n  var mustReorder = typeof getAttr(dom, 'no-reorder') !== T_STRING || remAttr(dom, 'no-reorder'),\n    tagName = getTagName(dom),\n    impl = __tagImpl[tagName] || { tmpl: getOuterHTML(dom) },\n    useRoot = SPECIAL_TAGS_REGEX.test(tagName),\n    root = dom.parentNode,\n    ref = document.createTextNode(''),\n    child = getTag(dom),\n    isOption = tagName.toLowerCase() === 'option', // the option tags must be treated differently\n    tags = [],\n    oldItems = [],\n    hasKeys,\n    isVirtual = dom.tagName == 'VIRTUAL'\n\n  // parse the each expression\n  expr = tmpl.loopKeys(expr)\n\n  // insert a marked where the loop tags will be injected\n  root.insertBefore(ref, dom)\n\n  // clean template code\n  parent.one('before-mount', function () {\n\n    // remove the original DOM node\n    dom.parentNode.removeChild(dom)\n    if (root.stub) root = parent.root\n\n  }).on('update', function () {\n    // get the new items collection\n    var items = tmpl(expr.val, parent),\n      // create a fragment to hold the new DOM nodes to inject in the parent tag\n      frag = document.createDocumentFragment()\n\n    // object loop. any changes cause full redraw\n    if (!isArray(items)) {\n      hasKeys = items || false\n      items = hasKeys ?\n        Object.keys(items).map(function (key) {\n          return mkitem(expr, key, items[key])\n        }) : []\n    }\n\n    // loop all the new items\n    var i = 0,\n      itemsLength = items.length\n\n    for (; i < itemsLength; i++) {\n      // reorder only if the items are objects\n      var\n        item = items[i],\n        _mustReorder = mustReorder && typeof item == T_OBJECT && !hasKeys,\n        oldPos = oldItems.indexOf(item),\n        pos = ~oldPos && _mustReorder ? oldPos : i,\n        // does a tag exist in this position?\n        tag = tags[pos]\n\n      item = !hasKeys && expr.key ? mkitem(expr, item, i) : item\n\n      // new tag\n      if (\n        !_mustReorder && !tag // with no-reorder we just update the old tags\n        ||\n        _mustReorder && !~oldPos || !tag // by default we always try to reorder the DOM elements\n      ) {\n\n        tag = new Tag(impl, {\n          parent: parent,\n          isLoop: true,\n          hasImpl: !!__tagImpl[tagName],\n          root: useRoot ? root : dom.cloneNode(),\n          item: item\n        }, dom.innerHTML)\n\n        tag.mount()\n\n        if (isVirtual) tag._root = tag.root.firstChild // save reference for further moves or inserts\n        // this tag must be appended\n        if (i == tags.length || !tags[i]) { // fix 1581\n          if (isVirtual)\n            addVirtual(tag, frag)\n          else frag.appendChild(tag.root)\n        }\n        // this tag must be insert\n        else {\n          if (isVirtual)\n            addVirtual(tag, root, tags[i])\n          else root.insertBefore(tag.root, tags[i].root) // #1374 some browsers reset selected here\n          oldItems.splice(i, 0, item)\n        }\n\n        tags.splice(i, 0, tag)\n        pos = i // handled here so no move\n      } else tag.update(item, true)\n\n      // reorder the tag if it's not located in its previous position\n      if (\n        pos !== i && _mustReorder &&\n        tags[i] // fix 1581 unable to reproduce it in a test!\n      ) {\n        // update the DOM\n        if (isVirtual)\n          moveVirtual(tag, root, tags[i], dom.childNodes.length)\n        else root.insertBefore(tag.root, tags[i].root)\n        // update the position attribute if it exists\n        if (expr.pos)\n          tag[expr.pos] = i\n        // move the old tag instance\n        tags.splice(i, 0, tags.splice(pos, 1)[0])\n        // move the old item\n        oldItems.splice(i, 0, oldItems.splice(pos, 1)[0])\n        // if the loop tags are not custom\n        // we need to move all their custom tags into the right position\n        if (!child && tag.tags) moveNestedTags(tag, i)\n      }\n\n      // cache the original item to use it in the events bound to this node\n      // and its children\n      tag._item = item\n      // cache the real parent tag internally\n      defineProperty(tag, '_parent', parent)\n    }\n\n    // remove the redundant tags\n    unmountRedundant(items, tags)\n\n    // insert the new nodes\n    root.insertBefore(frag, ref)\n    if (isOption) {\n\n      // #1374 FireFox bug in <option selected={expression}>\n      if (FIREFOX && !root.multiple) {\n        for (var n = 0; n < root.length; n++) {\n          if (root[n].__riot1374) {\n            root.selectedIndex = n  // clear other options\n            delete root[n].__riot1374\n            break\n          }\n        }\n      }\n    }\n\n    // set the 'tags' property of the parent tag\n    // if child is 'undefined' it means that we don't need to set this property\n    // for example:\n    // we don't need store the `myTag.tags['div']` property if we are looping a div tag\n    // but we need to track the `myTag.tags['child']` property looping a custom child node named `child`\n    if (child) parent.tags[tagName] = tags\n\n    // clone the items array\n    oldItems = items.slice()\n\n  })\n\n}\n/**\n * Object that will be used to inject and manage the css of every tag instance\n */\nvar styleManager = (function(_riot) {\n\n  if (!window) return { // skip injection on the server\n    add: function () {},\n    inject: function () {}\n  }\n\n  var styleNode = (function () {\n    // create a new style element with the correct type\n    var newNode = mkEl('style')\n    setAttr(newNode, 'type', 'text/css')\n\n    // replace any user node or insert the new one into the head\n    var userNode = $('style[type=riot]')\n    if (userNode) {\n      if (userNode.id) newNode.id = userNode.id\n      userNode.parentNode.replaceChild(newNode, userNode)\n    }\n    else document.getElementsByTagName('head')[0].appendChild(newNode)\n\n    return newNode\n  })()\n\n  // Create cache and shortcut to the correct property\n  var cssTextProp = styleNode.styleSheet,\n    stylesToInject = ''\n\n  // Expose the style node in a non-modificable property\n  Object.defineProperty(_riot, 'styleNode', {\n    value: styleNode,\n    writable: true\n  })\n\n  /**\n   * Public api\n   */\n  return {\n    /**\n     * Save a tag style to be later injected into DOM\n     * @param   { String } css [description]\n     */\n    add: function(css) {\n      stylesToInject += css\n    },\n    /**\n     * Inject all previously saved tag styles into DOM\n     * innerHTML seems slow: http://jsperf.com/riot-insert-style\n     */\n    inject: function() {\n      if (stylesToInject) {\n        if (cssTextProp) cssTextProp.cssText += stylesToInject\n        else styleNode.innerHTML += stylesToInject\n        stylesToInject = ''\n      }\n    }\n  }\n\n})(riot)\n\n\nfunction parseNamedElements(root, tag, childTags, forceParsingNamed) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = dom.isLoop ||\n                  (dom.parentNode && dom.parentNode.isLoop || getAttr(dom, 'each'))\n                    ? 1 : 0\n\n      // custom child tag\n      if (childTags) {\n        var child = getTag(dom)\n\n        if (child && !dom.isLoop)\n          childTags.push(initChildTag(child, {root: dom, parent: tag}, dom.innerHTML, tag))\n      }\n\n      if (!dom.isLoop || forceParsingNamed)\n        setNamed(dom, tag, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (tmpl.hasExpr(val)) {\n      expressions.push(extend({ dom: dom, expr: val }, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType,\n      attr\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    attr = getAttr(dom, 'each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n    opts = inherit(conf.opts) || {},\n    parent = conf.parent,\n    isLoop = conf.isLoop,\n    hasImpl = conf.hasImpl,\n    item = cleanUpData(conf.item),\n    expressions = [],\n    childTags = [],\n    root = conf.root,\n    tagName = root.tagName.toLowerCase(),\n    attr = {},\n    propsInSyncWithParent = [],\n    dom\n\n  // only call unmount if we have a valid __tagImpl (has name property)\n  if (impl.name && root._tag) root._tag.unmount(true)\n\n  // not yet mounted\n  this.isMounted = false\n  root.isLoop = isLoop\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  defineProperty(this, '_riot_id', ++__uid) // base 1 allows test !t._riot_id\n\n  extend(this, { parent: parent, root: root, opts: opts}, item)\n  // protect the \"tags\" property from being overridden\n  defineProperty(this, 'tags', {})\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (tmpl.hasExpr(val)) attr[el.name] = val\n  })\n\n  dom = mkdom(impl.tmpl, innerHTML)\n\n  // options\n  function updateOpts() {\n    var ctx = hasImpl && isLoop ? self : parent || self\n\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      var val = el.value\n      opts[toCamel(el.name)] = tmpl.hasExpr(val) ? tmpl(val, ctx) : val\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[toCamel(name)] = tmpl(attr[name], ctx)\n    })\n  }\n\n  function normalizeData(data) {\n    for (var key in item) {\n      if (typeof self[key] !== T_UNDEF && isWritable(self, key))\n        self[key] = data[key]\n    }\n  }\n\n  function inheritFromParent () {\n    if (!self.parent || !isLoop) return\n    each(Object.keys(self.parent), function(k) {\n      // some properties must be always in sync with the parent tag\n      var mustSync = !RESERVED_WORDS_BLACKLIST.test(k) && contains(propsInSyncWithParent, k)\n      if (typeof self[k] === T_UNDEF || mustSync) {\n        // track the property to keep in sync\n        // so we can keep it updated\n        if (!mustSync) propsInSyncWithParent.push(k)\n        self[k] = self.parent[k]\n      }\n    })\n  }\n\n  /**\n   * Update the tag expressions and options\n   * @param   { * }  data - data we want to use to extend the tag properties\n   * @param   { Boolean } isInherited - is this update coming from a parent tag?\n   * @returns { self }\n   */\n  defineProperty(this, 'update', function(data, isInherited) {\n\n    // make sure the data passed will not override\n    // the component core methods\n    data = cleanUpData(data)\n    // inherit properties from the parent\n    inheritFromParent()\n    // normalize the tag properties in case an item object was initially passed\n    if (data && isObject(item)) {\n      normalizeData(data)\n      item = data\n    }\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self)\n\n    // the updated event will be triggered\n    // once the DOM will be ready and all the re-flows are completed\n    // this is useful if you want to get the \"real\" root properties\n    // 4 ex: root.offsetWidth ...\n    if (isInherited && self.parent)\n      // closes #1599\n      self.parent.one('updated', function() { self.trigger('updated') })\n    else rAF(function() { self.trigger('updated') })\n\n    return this\n  })\n\n  defineProperty(this, 'mixin', function() {\n    each(arguments, function(mix) {\n      var instance,\n        props = [],\n        obj\n\n      mix = typeof mix === T_STRING ? riot.mixin(mix) : mix\n\n      // check if the mixin is a function\n      if (isFunction(mix)) {\n        // create the new mixin instance\n        instance = new mix()\n      } else instance = mix\n\n      // build multilevel prototype inheritance chain property list\n      do props = props.concat(Object.getOwnPropertyNames(obj || instance))\n      while (obj = Object.getPrototypeOf(obj || instance))\n\n      // loop the keys in the function prototype or the all object keys\n      each(props, function(key) {\n        // bind methods to self\n        if (key != 'init' && !self[key])\n          // apply method only if it does not already exist on the instance\n          self[key] = isFunction(instance[key]) ?\n            instance[key].bind(self) :\n            instance[key]\n      })\n\n      // init method will be called automatically\n      if (instance.init) instance.init.bind(self)()\n    })\n    return this\n  })\n\n  defineProperty(this, 'mount', function() {\n\n    updateOpts()\n\n    // add global mixins\n    var globalMixin = riot.mixin(GLOBAL_MIXIN)\n    if (globalMixin)\n      for (var i in globalMixin)\n        if (globalMixin.hasOwnProperty(i))\n          self.mixin(globalMixin[i])\n\n    // initialiation\n    if (impl.fn) impl.fn.call(self, opts)\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    // mount the child tags\n    toggle(true)\n\n    // update the root adding custom attributes coming from the compiler\n    // it fixes also #1087\n    if (impl.attrs)\n      walkAttributes(impl.attrs, function (k, v) { setAttr(root, k, v) })\n    if (impl.attrs || hasImpl)\n      parseExpressions(self.root, self, expressions)\n\n    if (!self.parent || isLoop) self.update(item)\n\n    // internal use only, fixes #403\n    self.trigger('before-mount')\n\n    if (isLoop && !hasImpl) {\n      // update the root attribute for the looped elements\n      root = dom.firstChild\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) root = parent.root\n    }\n\n    defineProperty(self, 'root', root)\n\n    // parse the named dom nodes in the looped child\n    // adding them to the parent as well\n    if (isLoop)\n      parseNamedElements(self.root, self.parent, null, true)\n\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  })\n\n\n  defineProperty(this, 'unmount', function(keepRootTag) {\n    var el = root,\n      p = el.parentNode,\n      ptag,\n      tagIndex = __virtualDom.indexOf(self)\n\n    self.trigger('before-unmount')\n\n    // remove this tag instance from the global virtualDom variable\n    if (~tagIndex)\n      __virtualDom.splice(tagIndex, 1)\n\n    if (p) {\n\n      if (parent) {\n        ptag = getImmediateCustomParentTag(parent)\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(ptag.tags[tagName]))\n          each(ptag.tags[tagName], function(tag, i) {\n            if (tag._riot_id == self._riot_id)\n              ptag.tags[tagName].splice(i, 1)\n          })\n        else\n          // otherwise just delete the tag instance\n          ptag.tags[tagName] = undefined\n      }\n\n      else\n        while (el.firstChild) el.removeChild(el.firstChild)\n\n      if (!keepRootTag)\n        p.removeChild(el)\n      else {\n        // the riot-tag and the data-is attributes aren't needed anymore, remove them\n        remAttr(p, RIOT_TAG_IS)\n        remAttr(p, RIOT_TAG) // this will be removed in riot 3.0.0\n      }\n\n    }\n\n    if (this._virts) {\n      each(this._virts, function(v) {\n        if (v.parentNode) v.parentNode.removeChild(v)\n      })\n    }\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    self.isMounted = false\n    delete root._tag\n\n  })\n\n  // proxy function to bind updates\n  // dispatched from a parent tag\n  function onChildUpdate(data) { self.update(data, true) }\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (!parent) return\n    var evt = isMount ? 'on' : 'off'\n\n    // the loop tags will be always in sync with the parent automatically\n    if (isLoop)\n      parent[evt]('unmount', self.unmount)\n    else {\n      parent[evt]('update', onChildUpdate)[evt]('unmount', self.unmount)\n    }\n  }\n\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n}\n/**\n * Attach an event to a DOM node\n * @param { String } name - event name\n * @param { Function } handler - event callback\n * @param { Object } dom - dom node\n * @param { Tag } tag - tag instance\n */\nfunction setEventHandler(name, handler, dom, tag) {\n\n  dom[name] = function(e) {\n\n    var ptag = tag._parent,\n      item = tag._item,\n      el\n\n    if (!item)\n      while (ptag && !item) {\n        item = ptag._item\n        ptag = ptag._parent\n      }\n\n    // cross browser event fix\n    e = e || window.event\n\n    // override the event properties\n    if (isWritable(e, 'currentTarget')) e.currentTarget = dom\n    if (isWritable(e, 'target')) e.target = e.srcElement\n    if (isWritable(e, 'which')) e.which = e.charCode || e.keyCode\n\n    e.item = item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      if (e.preventDefault) e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      el = item ? getImmediateCustomParentTag(ptag) : tag\n      el.update()\n    }\n\n  }\n\n}\n\n\n/**\n * Insert a DOM node replacing another one (used by if- attribute)\n * @param   { Object } root - parent node\n * @param   { Object } node - node replaced\n * @param   { Object } before - node added\n */\nfunction insertTo(root, node, before) {\n  if (!root) return\n  root.insertBefore(before, node)\n  root.removeChild(node)\n}\n\n/**\n * Update the expressions in a Tag instance\n * @param   { Array } expressions - expression that must be re evaluated\n * @param   { Tag } tag - tag instance\n */\nfunction update(expressions, tag) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n      attrName = expr.attr,\n      value = tmpl(expr.expr, tag),\n      parent = expr.dom.parentNode\n\n    if (expr.bool) {\n      value = !!value\n    } else if (value == null) {\n      value = ''\n    }\n\n    // #1638: regression of #1612, update the dom only if the value of the\n    // expression was changed\n    if (expr.value === value) {\n      return\n    }\n    expr.value = value\n\n    // textarea and text nodes has no attribute name\n    if (!attrName) {\n      // about #815 w/o replace: the browser converts the value to a string,\n      // the comparison by \"==\" does too, but not in the server\n      value += ''\n      // test for parent avoids error with invalid assignment to nodeValue\n      if (parent) {\n        if (parent.tagName === 'TEXTAREA') {\n          parent.value = value                    // #1113\n          if (!IE_VERSION) dom.nodeValue = value  // #1625 IE throws here, nodeValue\n        }                                         // will be available on 'updated'\n        else dom.nodeValue = value\n      }\n      return\n    }\n\n    // ~~#1612: look for changes in dom.value when updating the value~~\n    if (attrName === 'value') {\n      dom.value = value\n      return\n    }\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (isFunction(value)) {\n      setEventHandler(attrName, value, dom, tag)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub,\n        add = function() { insertTo(stub.parentNode, stub, dom) },\n        remove = function() { insertTo(dom.parentNode, dom, stub) }\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          add()\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted)\n                el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        // if the parentNode is defined we can easily replace the tag\n        if (dom.parentNode)\n          remove()\n        // otherwise we need to wait the updated event\n        else (tag.parent || tag).one('updated', remove)\n\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (attrName === 'show') {\n      dom.style.display = value ? '' : 'none'\n\n    } else if (attrName === 'hide') {\n      dom.style.display = value ? 'none' : ''\n\n    } else if (expr.bool) {\n      dom[attrName] = value\n      if (value) setAttr(dom, attrName, attrName)\n      if (FIREFOX && attrName === 'selected' && dom.tagName === 'OPTION') {\n        dom.__riot1374 = value   // #1374\n      }\n\n    } else if (value === 0 || value && typeof value !== T_OBJECT) {\n      // <img src=\"{ expr }\">\n      if (startsWith(attrName, RIOT_PREFIX) && attrName != RIOT_TAG) {\n        attrName = attrName.slice(RIOT_PREFIX.length)\n      }\n      setAttr(dom, attrName, value)\n    }\n\n  })\n\n}\n/**\n * Specialized function for looping an array-like collection with `each={}`\n * @param   { Array } els - collection of items\n * @param   {Function} fn - callback function\n * @returns { Array } the array looped\n */\nfunction each(els, fn) {\n  var len = els ? els.length : 0\n\n  for (var i = 0, el; i < len; i++) {\n    el = els[i]\n    // return false -> current item was removed by fn during the loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\n/**\n * Detect if the argument passed is a function\n * @param   { * } v - whatever you want to pass to this function\n * @returns { Boolean } -\n */\nfunction isFunction(v) {\n  return typeof v === T_FUNCTION || false   // avoid IE problems\n}\n\n/**\n * Get the outer html of any DOM node SVGs included\n * @param   { Object } el - DOM node to parse\n * @returns { String } el.outerHTML\n */\nfunction getOuterHTML(el) {\n  if (el.outerHTML) return el.outerHTML\n  // some browsers do not support outerHTML on the SVGs tags\n  else {\n    var container = mkEl('div')\n    container.appendChild(el.cloneNode(true))\n    return container.innerHTML\n  }\n}\n\n/**\n * Set the inner html of any DOM node SVGs included\n * @param { Object } container - DOM node where we will inject the new html\n * @param { String } html - html to inject\n */\nfunction setInnerHTML(container, html) {\n  if (typeof container.innerHTML != T_UNDEF) container.innerHTML = html\n  // some browsers do not support innerHTML on the SVGs tags\n  else {\n    var doc = new DOMParser().parseFromString(html, 'application/xml')\n    container.appendChild(\n      container.ownerDocument.importNode(doc.documentElement, true)\n    )\n  }\n}\n\n/**\n * Checks wether a DOM node must be considered part of an svg document\n * @param   { String }  name - tag name\n * @returns { Boolean } -\n */\nfunction isSVGTag(name) {\n  return ~SVG_TAGS_LIST.indexOf(name)\n}\n\n/**\n * Detect if the argument passed is an object, exclude null.\n * NOTE: Use isObject(x) && !isArray(x) to excludes arrays.\n * @param   { * } v - whatever you want to pass to this function\n * @returns { Boolean } -\n */\nfunction isObject(v) {\n  return v && typeof v === T_OBJECT         // typeof null is 'object'\n}\n\n/**\n * Remove any DOM attribute from a node\n * @param   { Object } dom - DOM node we want to update\n * @param   { String } name - name of the property we want to remove\n */\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\n/**\n * Convert a string containing dashes to camel case\n * @param   { String } string - input string\n * @returns { String } my-string -> myString\n */\nfunction toCamel(string) {\n  return string.replace(/-(\\w)/g, function(_, c) {\n    return c.toUpperCase()\n  })\n}\n\n/**\n * Get the value of any DOM attribute on a node\n * @param   { Object } dom - DOM node we want to parse\n * @param   { String } name - name of the attribute we want to get\n * @returns { String | undefined } name of the node attribute whether it exists\n */\nfunction getAttr(dom, name) {\n  return dom.getAttribute(name)\n}\n\n/**\n * Set any DOM attribute\n * @param { Object } dom - DOM node we want to update\n * @param { String } name - name of the property we want to set\n * @param { String } val - value of the property we want to set\n */\nfunction setAttr(dom, name, val) {\n  dom.setAttribute(name, val)\n}\n\n/**\n * Detect the tag implementation by a DOM node\n * @param   { Object } dom - DOM node we need to parse to get its tag implementation\n * @returns { Object } it returns an object containing the implementation of a custom tag (template and boot function)\n */\nfunction getTag(dom) {\n  return dom.tagName && __tagImpl[getAttr(dom, RIOT_TAG_IS) ||\n    getAttr(dom, RIOT_TAG) || dom.tagName.toLowerCase()]\n}\n/**\n * Add a child tag to its parent into the `tags` object\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the new tag will be stored\n * @param   { Object } parent - tag instance where the new child tag will be included\n */\nfunction addChildTag(tag, tagName, parent) {\n  var cachedTag = parent.tags[tagName]\n\n  // if there are multiple children tags having the same name\n  if (cachedTag) {\n    // if the parent tags property is not yet an array\n    // create it adding the first cached tag\n    if (!isArray(cachedTag))\n      // don't add the same tag twice\n      if (cachedTag !== tag)\n        parent.tags[tagName] = [cachedTag]\n    // add the new nested tag to the array\n    if (!contains(parent.tags[tagName], tag))\n      parent.tags[tagName].push(tag)\n  } else {\n    parent.tags[tagName] = tag\n  }\n}\n\n/**\n * Move the position of a custom tag in its parent tag\n * @param   { Object } tag - child tag instance\n * @param   { String } tagName - key where the tag was stored\n * @param   { Number } newPos - index where the new tag will be stored\n */\nfunction moveChildTag(tag, tagName, newPos) {\n  var parent = tag.parent,\n    tags\n  // no parent no move\n  if (!parent) return\n\n  tags = parent.tags[tagName]\n\n  if (isArray(tags))\n    tags.splice(newPos, 0, tags.splice(tags.indexOf(tag), 1)[0])\n  else addChildTag(tag, tagName, parent)\n}\n\n/**\n * Create a new child tag including it correctly into its parent\n * @param   { Object } child - child tag implementation\n * @param   { Object } opts - tag options containing the DOM node where the tag will be mounted\n * @param   { String } innerHTML - inner html of the child node\n * @param   { Object } parent - instance of the parent tag including the child custom tag\n * @returns { Object } instance of the new child tag just created\n */\nfunction initChildTag(child, opts, innerHTML, parent) {\n  var tag = new Tag(child, opts, innerHTML),\n    tagName = getTagName(opts.root),\n    ptag = getImmediateCustomParentTag(parent)\n  // fix for the parent attribute in the looped elements\n  tag.parent = ptag\n  // store the real parent tag\n  // in some cases this could be different from the custom parent tag\n  // for example in nested loops\n  tag._parent = parent\n\n  // add this tag to the custom parent tag\n  addChildTag(tag, tagName, ptag)\n  // and also to the real parent tag\n  if (ptag !== parent)\n    addChildTag(tag, tagName, parent)\n  // empty the child node once we got its template\n  // to avoid that its children get compiled multiple times\n  opts.root.innerHTML = ''\n\n  return tag\n}\n\n/**\n * Loop backward all the parents tree to detect the first custom parent tag\n * @param   { Object } tag - a Tag instance\n * @returns { Object } the instance of the first custom parent tag found\n */\nfunction getImmediateCustomParentTag(tag) {\n  var ptag = tag\n  while (!getTag(ptag.root)) {\n    if (!ptag.parent) break\n    ptag = ptag.parent\n  }\n  return ptag\n}\n\n/**\n * Helper function to set an immutable property\n * @param   { Object } el - object where the new property will be set\n * @param   { String } key - object key where the new property will be stored\n * @param   { * } value - value of the new property\n* @param   { Object } options - set the propery overriding the default options\n * @returns { Object } - the initial object\n */\nfunction defineProperty(el, key, value, options) {\n  Object.defineProperty(el, key, extend({\n    value: value,\n    enumerable: false,\n    writable: false,\n    configurable: true\n  }, options))\n  return el\n}\n\n/**\n * Get the tag name of any DOM node\n * @param   { Object } dom - DOM node we want to parse\n * @returns { String } name to identify this dom node in riot\n */\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = getAttr(dom, 'name'),\n    tagName = namedTag && !tmpl.hasExpr(namedTag) ?\n                namedTag :\n              child ? child.name : dom.tagName.toLowerCase()\n\n  return tagName\n}\n\n/**\n * Extend any object with other properties\n * @param   { Object } src - source object\n * @returns { Object } the resulting extended object\n *\n * var obj = { foo: 'baz' }\n * extend(obj, {bar: 'bar', foo: 'bar'})\n * console.log(obj) => {bar: 'bar', foo: 'bar'}\n *\n */\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if (obj = args[i]) {\n      for (var key in obj) {\n        // check if this property of the source object could be overridden\n        if (isWritable(src, key))\n          src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\n/**\n * Check whether an array contains an item\n * @param   { Array } arr - target array\n * @param   { * } item - item to test\n * @returns { Boolean } Does 'arr' contain 'item'?\n */\nfunction contains(arr, item) {\n  return ~arr.indexOf(item)\n}\n\n/**\n * Check whether an object is a kind of array\n * @param   { * } a - anything\n * @returns {Boolean} is 'a' an array?\n */\nfunction isArray(a) { return Array.isArray(a) || a instanceof Array }\n\n/**\n * Detect whether a property of an object could be overridden\n * @param   { Object }  obj - source object\n * @param   { String }  key - object property\n * @returns { Boolean } is this property writable?\n */\nfunction isWritable(obj, key) {\n  var props = Object.getOwnPropertyDescriptor(obj, key)\n  return typeof obj[key] === T_UNDEF || props && props.writable\n}\n\n\n/**\n * With this function we avoid that the internal Tag methods get overridden\n * @param   { Object } data - options we want to use to extend the tag instance\n * @returns { Object } clean object without containing the riot internal reserved words\n */\nfunction cleanUpData(data) {\n  if (!(data instanceof Tag) && !(data && typeof data.trigger == T_FUNCTION))\n    return data\n\n  var o = {}\n  for (var key in data) {\n    if (!RESERVED_WORDS_BLACKLIST.test(key)) o[key] = data[key]\n  }\n  return o\n}\n\n/**\n * Walk down recursively all the children tags starting dom node\n * @param   { Object }   dom - starting node where we will start the recursion\n * @param   { Function } fn - callback to transform the child node just found\n */\nfunction walk(dom, fn) {\n  if (dom) {\n    // stop the recursion\n    if (fn(dom) === false) return\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\n/**\n * Minimize risk: only zero or one _space_ between attr & value\n * @param   { String }   html - html string we want to parse\n * @param   { Function } fn - callback function to apply on any attribute found\n */\nfunction walkAttributes(html, fn) {\n  var m,\n    re = /([-\\w]+) ?= ?(?:\"([^\"]*)|'([^']*)|({[^}]*}))/g\n\n  while (m = re.exec(html)) {\n    fn(m[1].toLowerCase(), m[2] || m[3] || m[4])\n  }\n}\n\n/**\n * Check whether a DOM node is in stub mode, useful for the riot 'if' directive\n * @param   { Object }  dom - DOM node we want to parse\n * @returns { Boolean } -\n */\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\n/**\n * Create a generic DOM node\n * @param   { String } name - name of the DOM node we want to create\n * @param   { Boolean } isSvg - should we use a SVG as parent node?\n * @returns { Object } DOM node just created\n */\nfunction mkEl(name, isSvg) {\n  return isSvg ?\n    document.createElementNS('http://www.w3.org/2000/svg', 'svg') :\n    document.createElement(name)\n}\n\n/**\n * Shorter and fast way to select multiple nodes in the DOM\n * @param   { String } selector - DOM selector\n * @param   { Object } ctx - DOM node where the targets of our search will is located\n * @returns { Object } dom nodes found\n */\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\n/**\n * Shorter and fast way to select a single node in the DOM\n * @param   { String } selector - unique dom selector\n * @param   { Object } ctx - DOM node where the target of our search will is located\n * @returns { Object } dom node found\n */\nfunction $(selector, ctx) {\n  return (ctx || document).querySelector(selector)\n}\n\n/**\n * Simple object prototypal inheritance\n * @param   { Object } parent - parent object\n * @returns { Object } child instance\n */\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\n/**\n * Get the name property needed to identify a DOM node in riot\n * @param   { Object } dom - DOM node we need to parse\n * @returns { String | undefined } give us back a string to identify this dom node\n */\nfunction getNamedKey(dom) {\n  return getAttr(dom, 'id') || getAttr(dom, 'name')\n}\n\n/**\n * Set the named properties of a tag element\n * @param { Object } dom - DOM node we need to parse\n * @param { Object } parent - tag instance where the named dom element will be eventually added\n * @param { Array } keys - list of all the tag instance properties\n */\nfunction setNamed(dom, parent, keys) {\n  // get the key value we want to add to the tag instance\n  var key = getNamedKey(dom),\n    isArr,\n    // add the node detected to a tag instance using the named property\n    add = function(value) {\n      // avoid to override the tag properties already set\n      if (contains(keys, key)) return\n      // check whether this value is an array\n      isArr = isArray(value)\n      // if the key was never set\n      if (!value)\n        // set it once on the tag instance\n        parent[key] = dom\n      // if it was an array and not yet set\n      else if (!isArr || isArr && !contains(value, dom)) {\n        // add the dom node into the array\n        if (isArr)\n          value.push(dom)\n        else\n          parent[key] = [value, dom]\n      }\n    }\n\n  // skip the elements with no named properties\n  if (!key) return\n\n  // check whether this key has been already evaluated\n  if (tmpl.hasExpr(key))\n    // wait the first updated event only once\n    parent.one('mount', function() {\n      key = getNamedKey(dom)\n      add(parent[key])\n    })\n  else\n    add(parent[key])\n\n}\n\n/**\n * Faster String startsWith alternative\n * @param   { String } src - source string\n * @param   { String } str - test string\n * @returns { Boolean } -\n */\nfunction startsWith(src, str) {\n  return src.slice(0, str.length) === str\n}\n\n/**\n * requestAnimationFrame function\n * Adapted from https://gist.github.com/paulirish/1579671, license MIT\n */\nvar rAF = (function (w) {\n  var raf = w.requestAnimationFrame    ||\n            w.mozRequestAnimationFrame || w.webkitRequestAnimationFrame\n\n  if (!raf || /iP(ad|hone|od).*OS 6/.test(w.navigator.userAgent)) {  // buggy iOS6\n    var lastTime = 0\n\n    raf = function (cb) {\n      var nowtime = Date.now(), timeout = Math.max(16 - (nowtime - lastTime), 0)\n      setTimeout(function () { cb(lastTime = nowtime + timeout) }, timeout)\n    }\n  }\n  return raf\n\n})(window || {})\n\n/**\n * Mount a tag creating new Tag instance\n * @param   { Object } root - dom node where the tag will be mounted\n * @param   { String } tagName - name of the riot tag we want to mount\n * @param   { Object } opts - options to pass to the Tag instance\n * @returns { Tag } a new Tag instance\n */\nfunction mountTo(root, tagName, opts) {\n  var tag = __tagImpl[tagName],\n    // cache the inner HTML to fix #855\n    innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    // add this tag to the virtualDom variable\n    if (!contains(__virtualDom, tag)) __virtualDom.push(tag)\n  }\n\n  return tag\n}\n/**\n * Riot public api\n */\n\n// share methods for other riot parts, e.g. compiler\nriot.util = { brackets: brackets, tmpl: tmpl }\n\n/**\n * Create a mixin that could be globally shared across all the tags\n */\nriot.mixin = (function() {\n  var mixins = {},\n    globals = mixins[GLOBAL_MIXIN] = {},\n    _id = 0\n\n  /**\n   * Create/Return a mixin by its name\n   * @param   { String }  name - mixin name (global mixin if object)\n   * @param   { Object }  mixin - mixin logic\n   * @param   { Boolean } g - is global?\n   * @returns { Object }  the mixin logic\n   */\n  return function(name, mixin, g) {\n    // Unnamed global\n    if (isObject(name)) {\n      riot.mixin('__unnamed_'+_id++, name, true)\n      return\n    }\n\n    var store = g ? globals : mixins\n\n    // Getter\n    if (!mixin) {\n      if (typeof store[name] === T_UNDEF) {\n        throw new Error('Unregistered mixin: ' + name)\n      }\n      return store[name]\n    }\n    // Setter\n    if (isFunction(mixin)) {\n      extend(mixin.prototype, store[name] || {})\n      store[name] = mixin\n    }\n    else {\n      store[name] = extend(store[name] || {}, mixin)\n    }\n  }\n\n})()\n\n/**\n * Create a new riot tag implementation\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @returns { String } name/id of the tag just created\n */\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else styleManager.add(css)\n  }\n  name = name.toLowerCase()\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Create a new riot tag implementation (for use by the compiler)\n * @param   { String }   name - name/id of the new riot tag\n * @param   { String }   html - tag template\n * @param   { String }   css - custom tag css\n * @param   { String }   attrs - root tag attributes\n * @param   { Function } fn - user function\n * @returns { String } name/id of the tag just created\n */\nriot.tag2 = function(name, html, css, attrs, fn) {\n  if (css) styleManager.add(css)\n  //if (bpair) riot.settings.brackets = bpair\n  __tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\n/**\n * Mount a tag using a specific tag implementation\n * @param   { String } selector - tag DOM selector\n * @param   { String } tagName - tag implementation name\n * @param   { Object } opts - tag logic\n * @returns { Array } new tags instances\n */\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n    allTags,\n    tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      if (!/[^-\\w]/.test(e)) {\n        e = e.trim().toLowerCase()\n        list += ',[' + RIOT_TAG_IS + '=\"' + e + '\"],[' + RIOT_TAG + '=\"' + e + '\"]'\n      }\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(__tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    if (root.tagName) {\n      var riotTag = getAttr(root, RIOT_TAG_IS) || getAttr(root, RIOT_TAG)\n\n      // have tagName? force riot-tag to be the same\n      if (tagName && riotTag !== tagName) {\n        riotTag = tagName\n        setAttr(root, RIOT_TAG_IS, tagName)\n        setAttr(root, RIOT_TAG, tagName) // this will be removed in riot 3.0.0\n      }\n      var tag = mountTo(root, riotTag || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    } else if (root.length) {\n      each(root, pushTags)   // assume nodeList\n    }\n  }\n\n  // ----- mount code -----\n\n  // inject styles into DOM\n  styleManager.inject()\n\n  if (isObject(tagName)) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*')\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    else\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(/, */))\n\n    // make sure to pass always a selector\n    // to the querySelectorAll function\n    els = selector ? $$(selector) : []\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName)\n      els = $$(tagName, els)\n    else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  pushTags(els)\n\n  return tags\n}\n\n/**\n * Update all the tags instances created\n * @returns { Array } all the tags instances\n */\nriot.update = function() {\n  return each(__virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n/**\n * Export the Virtual DOM\n */\nriot.vdom = __virtualDom\n\n/**\n * Export the Tag constructor\n */\nriot.Tag = Tag\n  // support CommonJS, AMD & browser\n  /* istanbul ignore next */\n  if (typeof exports === T_OBJECT)\n    module.exports = riot\n  else if (typeof define === T_FUNCTION && typeof define.amd !== T_UNDEF)\n    define(function() { return riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : void 0);\n","var riot = require('riot');\nmodule.exports = \nriot.tag2('app', '<board></board>', 'board { position: absolute; top: 0; left: 0; bottom: 0; right: 0; }', '', function(opts) {\n});","var riot = require('riot');\nmodule.exports = \nriot.tag2('board', '<button class=\"btn\" onclick=\"{addnote}\">Add Note</button> <note each=\"{note,idx in notes}\" no-reorder riot-style=\"top:{note.top}px;left:{note.left}px;z-index:{idx==active?5:1}\" idx=\"{idx}\" editing=\"{note.editing}\" text=\"{note.text}\" chosen=\"{parent.noteSelected}\" changed=\"{parent.noteChange}\"></note>', 'board { border: 1px solid #ccc; background: #ccc; } .btn { border: 1px solid #ccc; background: rgba(255,255,255,0.8); border-radius: 4px; padding: 5px 8px; font-size: 14px; } .btn:active, .btn:focus { background: #fff; outline: 0px; }', '', function(opts) {\nthis.notes = [];\n\nthis.on('mount', function() {\n  this.socket = new WebSocket('ws://127.0.0.1:3000');\n  this.socket.onopen = (function(_this) {\n    return function() {\n      return _this.getNotes();\n    };\n  })(this);\n  return this.socket.onmessage = (function(_this) {\n    return function(res) {\n      var message;\n      message = JSON.parse(res.data);\n      switch (message.type) {\n        case \"notes:all\":\n          return _this.updateAll(message.notes);\n        default:\n          return console.log(message.type, \"unhandled\");\n      }\n    };\n  })(this);\n});\n\nthis.addnote = (function(_this) {\n  return function() {\n    var data;\n    _this.notes.push({\n      top: 100,\n      left: 100,\n      text: \"New Note\",\n      editing: false\n    });\n    data = {\n      type: \"notes:add\",\n      note: {\n        top: 100,\n        left: 100,\n        text: \"New Note\"\n      }\n    };\n    _this.socket.send(JSON.stringify(data));\n    return _this.update();\n  };\n})(this);\n\nthis.noteSelected = (function(_this) {\n  return function(idx) {\n    console.log('selected', idx);\n    _this.active = idx;\n    return _this.update();\n  };\n})(this);\n\nthis.noteChange = (function(_this) {\n  return function(idx, note) {\n    note.id = _this.notes[idx].id;\n    _this.notes[idx] = note;\n    if (!note.editing) {\n      _this.socket.send(JSON.stringify({\n        type: \"notes:update\",\n        note: note\n      }));\n    }\n    return _this.update();\n  };\n})(this);\n\nthis.getNotes = (function(_this) {\n  return function() {\n    var data;\n    data = {\n      type: \"notes:getAll\"\n    };\n    return _this.socket.send(JSON.stringify(data));\n  };\n})(this);\n\nthis.updateAll = (function(_this) {\n  return function(notes) {\n    _this.notes = notes;\n    console.log('updateAll', _this.notes);\n    return _this.update();\n  };\n})(this);\n});","var riot = require('riot');\nmodule.exports = \nriot.tag2('note', '<div class=\"wrap pre\" if=\"{!opts.editing}\">{opts.text} <button class=\"btn editbutton\" onclick=\"{startEdit}\">Edit</button> </div> <div if=\"{opts.editing}\"> <textarea name=\"text\" value=\"{opts.text}\"></textarea> <button class=\"btn editbutton\" onclick=\"{endEdit}\">Save</button> </div>', 'note { display: block; color: #333; position: absolute; width: 200px; min-height: 200px; margin: 0 auto; padding: 10px; font-size: 21px; -webkit-box-shadow: 0 10px 10px 2px rgba(0,0,0,0.3); box-shadow: 0 10px 10px 2px rgba(0,0,0,0.3); background: #eae672; } note .pre { white-space: pre; } note.animate { -webkit-transition: all 0.5s ease; -moz-transition: all 0.5s ease; -o-transition: all 0.5s ease; -ms-transition: all 0.5s ease; transition: all 0.5s ease; } .editbutton { position: absolute; bottom: 10px; right: 10px; } note textarea { width: 100%; background: transparent; border: 0px; padding: 10px; outline: 1px dotted #444; resize: none; min-height: 140px; font-size: 21px; }', 'onmousedown=\"{dragstart}\" ondblclick=\"{startEdit}\"', function(opts) {\nthis.on('mount', function() {\n  return this.root.className += \" animate\";\n});\n\nthis.dragstart = (function(_this) {\n  return function(e) {\n    _this.moved = false;\n    _this.root.className = _this.root.className.replace(/ ?animate/, '');\n    if (opts.chosen) {\n      opts.chosen(opts.idx);\n    }\n    _this.startNote = _this.root.getBoundingClientRect();\n    _this.startMouse = {\n      x: e.clientX,\n      y: e.clientY\n    };\n    _this.updateOffset(_this.startMouse);\n    if (opts.editing) {\n      return true;\n    }\n    document.addEventListener('mousemove', _this.dragging);\n    return document.addEventListener('mouseup', _this.dragend);\n  };\n})(this);\n\nthis.dragging = (function(_this) {\n  return function(e) {\n    _this.moved = true;\n    _this.pos = {\n      x: e.clientX,\n      y: e.clientY\n    };\n    _this.updateOffset(_this.pos);\n    _this.root.style.left = _this.offset.x + \"px\";\n    return _this.root.style.top = _this.offset.y + \"px\";\n  };\n})(this);\n\nthis.updateOffset = (function(_this) {\n  return function(pos) {\n    return _this.offset = {\n      x: pos.x - _this.startMouse.x + _this.startNote.left,\n      y: pos.y - _this.startMouse.y + _this.startNote.top\n    };\n  };\n})(this);\n\nthis.dragend = (function(_this) {\n  return function(e) {\n    _this.root.className += \" animate\";\n    document.removeEventListener('mousemove', _this.dragging);\n    document.removeEventListener('mouseup', _this.dragend);\n    if (_this.moved) {\n      return opts.changed(opts.idx, {\n        top: _this.offset.y,\n        left: _this.offset.x,\n        text: opts.text,\n        editing: opts.editing\n      });\n    }\n  };\n})(this);\n\nthis.startEdit = (function(_this) {\n  return function() {\n    return opts.changed(opts.idx, {\n      top: _this.offset.y,\n      left: _this.offset.x,\n      text: opts.text,\n      editing: true\n    });\n  };\n})(this);\n\nthis.endEdit = (function(_this) {\n  return function() {\n    return opts.changed(opts.idx, {\n      top: _this.offset.y,\n      left: _this.offset.x,\n      text: _this.text.value,\n      editing: false\n    });\n  };\n})(this);\n});"]}